"use strict";(self.webpackChunkmediacore_frontend=self.webpackChunkmediacore_frontend||[]).push([[9803],{13416:(e,s,a)=>{a.d(s,{T:()=>c});var l=a(27051),t=a(53986),i=a(65043),r=a(99766),n=a(70579);const d=["className"],c=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,d);return(0,n.jsx)("textarea",(0,l.A)({className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s},i))});c.displayName="Textarea"},19690:(e,s,a)=>{a.d(s,{Xi:()=>h,av:()=>p,j7:()=>x,tU:()=>u});var l=a(27051),t=a(53986),i=a(65043),r=a(47127),n=a(99766),d=a(70579);const c=["className"],o=["className"],m=["className"],u=r.bL,x=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,c);return(0,d.jsx)(r.B8,(0,l.A)({ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a)},i))});x.displayName=r.B8.displayName;const h=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,o);return(0,d.jsx)(r.l9,(0,l.A)({ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a)},i))});h.displayName=r.l9.displayName;const p=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,m);return(0,d.jsx)(r.UC,(0,l.A)({ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a)},i))});p.displayName=r.UC.displayName},31555:(e,s,a)=>{a.d(s,{E:()=>d});var l=a(27051),t=a(53986),i=(a(65043),a(99766)),r=a(70579);const n=["className"];function d(e){let{className:s}=e,a=(0,t.A)(e,n);return(0,r.jsx)("div",(0,l.A)({className:(0,i.cn)("animate-pulse rounded-md bg-muted",s)},a))}},49803:(e,s,a)=>{a.r(s),a.d(s,{default:()=>ae});var l=a(27051),t=a(65043),i=a(73216),r=a(35475),n=a(63248),d=a(12265),c=a(47097),o=a(14459),m=a(65469),u=a(48186),x=a(64265),h=a(70764),p=a(9855),g=a(71360),j=a(29521),v=a(19829),f=a(64830),b=a(36360),N=a(94965),y=a(57170),A=a(9333),w=a(41680),C=a(70067),k=a(40614),S=a(36210),E=a(84259),T=a(38276),I=a(94505),D=a(18717),F=a(91140),L=a(92264),R=a(13390),$=a(5949),M=a(20556),z=a(13416),J=a(31555),O=a(65598),q=a(17484),Q=a(84370),B=a(19690),P=a(65005),U=a(16784),_=a(73002),G=a(39292),V=a(79722),Z=a(99766),W=a(70579);const K="https://mediacoreapi-sql.masakalirestrobar.ca",X=e=>{switch(e){case"video":return A.A;case"audio":return v.A;case"image":return C.A;case"subtitle":return w.A;case"folder":return U.A;default:return _.A}},H=e=>{if(!e)return"0 B";const s=Math.floor(Math.log(e)/Math.log(1024));return"".concat((e/Math.pow(1024,s)).toFixed(1)," ").concat(["B","KB","MB","GB"][s])};function Y(e){let{open:s,onOpenChange:a,onSelect:l,multiSelect:i=!0,allowedTypes:r=null,title:n="Select Files",description:c="Choose files from your file manager"}=e;const[o,m]=(0,t.useState)(""),[u,x]=(0,t.useState)("all"),[h,p]=(0,t.useState)(""),[g,j]=(0,t.useState)([]),{data:v,isLoading:f}=(0,d.I)({queryKey:["file-picker",o,u],queryFn:async()=>{const e=localStorage.getItem("accessToken");return(await V.A.get("".concat(K,"/api/files"),{params:{dir:o,type:u},headers:{Authorization:"Bearer ".concat(e)}})).data},enabled:s}),N=((null===v||void 0===v?void 0:v.data)||[]).filter(e=>!!e.isDirectory||(!(r&&r.length>0)||r.includes(e.type))).filter(e=>!h||e.name.toLowerCase().includes(h.toLowerCase())),y=e=>{const s=e.isDirectory&&"hls"===e.type;!e.isDirectory||s?j(i?s=>s.find(s=>s.id===e.id)?s.filter(s=>s.id!==e.id):[...s,e]:[e]):m(e.path)},A=o?o.split("/").filter(Boolean):[];return(0,W.jsx)(O.lG,{open:s,onOpenChange:a,children:(0,W.jsxs)(O.Cf,{className:"max-w-4xl max-h-[80vh]",children:[(0,W.jsxs)(O.c7,{children:[(0,W.jsx)(O.L3,{children:n}),(0,W.jsx)(O.rr,{children:c})]}),(0,W.jsxs)("div",{className:"flex gap-3",children:[(0,W.jsxs)("div",{className:"relative flex-1",children:[(0,W.jsx)(G.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,W.jsx)(L.p,{placeholder:"Search files...",value:h,onChange:e=>p(e.target.value),className:"pl-10"})]}),(0,W.jsxs)(Q.l6,{value:u,onValueChange:x,children:[(0,W.jsx)(Q.bq,{className:"w-[150px]",children:(0,W.jsx)(Q.yv,{})}),(0,W.jsxs)(Q.gC,{children:[(0,W.jsx)(Q.eb,{value:"all",children:"All Types"}),(0,W.jsx)(Q.eb,{value:"video",children:"Videos"}),(0,W.jsx)(Q.eb,{value:"audio",children:"Audio"}),(0,W.jsx)(Q.eb,{value:"subtitle",children:"Subtitles"}),(0,W.jsx)(Q.eb,{value:"image",children:"Images"}),(0,W.jsx)(Q.eb,{value:"hls",children:"HLS"})]})]})]}),(0,W.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,W.jsx)(R.$,{variant:"ghost",size:"sm",onClick:()=>m(""),className:(0,Z.cn)(!o&&"font-semibold"),children:"Root"}),A.map((e,s)=>(0,W.jsxs)(t.Fragment,{children:[(0,W.jsx)("span",{className:"text-muted-foreground",children:"/"}),(0,W.jsx)(R.$,{variant:"ghost",size:"sm",onClick:()=>m(A.slice(0,s+1).join("/")),className:(0,Z.cn)(s===A.length-1&&"font-semibold"),children:e})]},s))]}),g.length>0&&(0,W.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-primary/10 rounded-lg",children:[(0,W.jsx)(S.A,{className:"h-4 w-4 text-primary"}),(0,W.jsxs)("span",{className:"text-sm font-medium",children:[g.length," file",g.length>1?"s":""," selected"]})]}),(0,W.jsx)("div",{className:"border rounded-lg max-h-[400px] overflow-y-auto",children:f?(0,W.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,W.jsx)(b.A,{className:"h-8 w-8 animate-spin text-primary"})}):0===N.length?(0,W.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 text-center",children:[(0,W.jsx)(U.A,{className:"h-12 w-12 text-muted-foreground mb-2"}),(0,W.jsx)("p",{className:"text-sm text-muted-foreground",children:h?"No files found":"This folder is empty"})]}):(0,W.jsx)("div",{className:"p-4 space-y-2",children:N.map(e=>{const s=X(e.type),a=g.find(s=>s.id===e.id),l=e.isDirectory&&"hls"===e.type;return(0,W.jsxs)("div",{className:(0,Z.cn)("flex items-center gap-3 p-3 rounded-lg border cursor-pointer hover:border-primary/50 transition-colors",a&&"border-primary bg-primary/5"),onClick:()=>y(e),children:[(!e.isDirectory||l)&&(0,W.jsx)(P.S,{checked:!!a,onCheckedChange:()=>y(e),onClick:e=>e.stopPropagation()}),(0,W.jsx)(s,{className:(0,Z.cn)("h-5 w-5","video"===e.type&&"text-blue-500","audio"===e.type&&"text-purple-500","image"===e.type&&"text-green-500","subtitle"===e.type&&"text-orange-500","folder"===e.type&&"text-yellow-500","hls"===e.type&&"text-cyan-500")}),(0,W.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,W.jsx)("p",{className:"text-sm font-medium truncate",children:e.name}),(0,W.jsx)("p",{className:"text-xs text-muted-foreground",children:e.isDirectory?"".concat(e.itemCount||0," items"):H(e.size)})]}),(0,W.jsx)($.E,{variant:"secondary",className:"text-xs",children:e.type})]},e.id)})})}),(0,W.jsxs)(O.Es,{children:[(0,W.jsx)(R.$,{variant:"ghost",onClick:()=>{j([]),m(""),p(""),a(!1)},children:"Cancel"}),(0,W.jsxs)(R.$,{onClick:()=>{l(g),j([]),m(""),p("")},disabled:0===g.length,children:["Select ",g.length>0&&"(".concat(g.length,")")]})]})]})})}const ee="https://mediacoreapi-sql.masakalirestrobar.ca",se=[{value:"album",label:"Album"},{value:"single",label:"Single"},{value:"ep",label:"EP"},{value:"compilation",label:"Compilation"},{value:"audiobook",label:"Audiobook"},{value:"lecture",label:"Lecture Series"}];function ae(){const{artistId:e}=(0,i.g)(),s=(0,i.Zp)(),a=(0,n.jE)(),{addToast:E}=(0,D.j_)(),{playTrack:T,setQueue:U}=(0,D.ut)(),[_,G]=(0,t.useState)("albums"),[K,X]=(0,t.useState)(!1),[H,ae]=(0,t.useState)(!1),[te,ie]=(0,t.useState)(!1),[re,ne]=(0,t.useState)(!1),[de,ce]=(0,t.useState)(!1),[oe,me]=(0,t.useState)(!1),[ue,xe]=(0,t.useState)(!1),[he,pe]=(0,t.useState)(null),[ge,je]=(0,t.useState)([]),[ve,fe]=(0,t.useState)("existing"),[be,Ne]=(0,t.useState)([]),[ye,Ae]=(0,t.useState)({}),[we,Ce]=(0,t.useState)(!1),[ke,Se]=(0,t.useState)({title:"",description:"",coverImage:"",releaseDate:"",genre:"",type:"album"}),[Ee,Te]=(0,t.useState)({name:"",bio:"",genre:"",image:"",website:""}),{data:Ie,isLoading:De}=(0,d.I)({queryKey:["artist",e],queryFn:()=>I.O0.getArtistById(e),enabled:!!e}),{data:Fe,isLoading:Le}=(0,d.I)({queryKey:["artist-albums",e],queryFn:()=>I.O0.getArtistAlbums(e),enabled:!!e}),{data:Re,isLoading:$e}=(0,d.I)({queryKey:["artist-media",e],queryFn:()=>I.O0.getArtistMedia(e),enabled:!!e}),{data:Me}=(0,d.I)({queryKey:["admin-media"],queryFn:()=>I.O0.getMedia({limit:500})}),ze=null===Ie||void 0===Ie?void 0:Ie.data,Je=(0,t.useMemo)(()=>(null===Fe||void 0===Fe?void 0:Fe.data)||[],[null===Fe||void 0===Fe?void 0:Fe.data]),Oe=(0,t.useMemo)(()=>(null===Re||void 0===Re?void 0:Re.data)||[],[null===Re||void 0===Re?void 0:Re.data]),qe=(0,t.useMemo)(()=>(null===Me||void 0===Me?void 0:Me.data)||[],[null===Me||void 0===Me?void 0:Me.data]),[Qe,Be]=(0,t.useState)({}),Pe=(0,t.useMemo)(()=>{const e=new Set;return Je.forEach(s=>{(Qe[s.id]||[]).forEach(s=>e.add(s.id))}),qe.filter(s=>!e.has(s.id))},[qe,Je,Qe]),Ue=async e=>{if(Qe[e])return Qe[e];try{const s=await I.O0.getAlbumMedia(e),a=(null===s||void 0===s?void 0:s.data)||[];return Be(s=>(0,l.A)((0,l.A)({},s),{},{[e]:a})),a}catch(s){return console.error("Failed to fetch album tracks:",s),[]}},_e=(0,c.n)({mutationFn:s=>I.ic.createAlbum((0,l.A)((0,l.A)({},s),{},{artistId:e})),onSuccess:()=>{a.invalidateQueries(["artist-albums",e]),X(!1),Se({title:"",description:"",coverImage:"",releaseDate:"",genre:"",type:"album"}),E({message:"Album created successfully",type:"success"})},onError:e=>{var s,a;E({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to create album",type:"error"})}}),Ge=(0,c.n)({mutationFn:e=>{let{id:s,data:a}=e;return I.ic.updateAlbum(s,a)},onSuccess:()=>{a.invalidateQueries(["artist-albums",e]),ae(!1),pe(null),E({message:"Album updated successfully",type:"success"})},onError:e=>{var s,a;E({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to update album",type:"error"})}}),Ve=(0,c.n)({mutationFn:e=>I.ic.deleteAlbum(e),onSuccess:()=>{a.invalidateQueries(["artist-albums",e]),a.invalidateQueries(["artist-media",e]),ie(!1),pe(null),E({message:"Album deleted successfully",type:"success"})},onError:e=>{var s,a;E({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to delete album",type:"error"})}}),Ze=(0,c.n)({mutationFn:s=>I.ic.updateArtist(e,s),onSuccess:()=>{a.invalidateQueries(["artist",e]),a.invalidateQueries(["artists"]),me(!1),E({message:"Artist updated successfully",type:"success"})},onError:e=>{var s,a;E({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to update artist",type:"error"})}}),We=(0,c.n)({mutationFn:()=>I.ic.deleteArtist(e,!0),onSuccess:()=>{a.invalidateQueries(["artists"]),s("/admin/artists"),E({message:"Artist deleted successfully",type:"success"})},onError:e=>{var s,a;E({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to delete artist",type:"error"})}}),Ke=(0,c.n)({mutationFn:e=>{let{albumId:s,mediaId:a,trackNumber:l}=e;return I.ic.addMediaToAlbum(s,a,l)},onSuccess:(s,t)=>{a.invalidateQueries(["album-media",t.albumId]),a.invalidateQueries(["artist-media",e]),Be(e=>{const s=(0,l.A)({},e);return delete s[t.albumId],s})},onError:e=>{var s,a;E({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to add track",type:"error"})}}),Xe=(0,c.n)({mutationFn:e=>{let{albumId:s,mediaId:a}=e;return I.ic.removeMediaFromAlbum(s,a)},onSuccess:(s,t)=>{a.invalidateQueries(["album-media",t.albumId]),a.invalidateQueries(["artist-media",e]),Be(e=>{const s=(0,l.A)({},e);return delete s[t.albumId],s}),E({message:"Track removed from album",type:"success"})},onError:e=>{var s,a;E({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to remove track",type:"error"})}}),He=(0,c.n)({mutationFn:e=>{let{albumId:s,tracks:a}=e;return I.ic.reorderAlbumTracks(s,a)},onSuccess:(e,s)=>{Be(e=>{const a=(0,l.A)({},e);return delete a[s.albumId],a})},onError:e=>{var s,a;E({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to reorder tracks",type:"error"})}});if(De)return(0,W.jsx)("div",{className:"space-y-6",children:(0,W.jsxs)("div",{className:"flex items-start gap-4",children:[(0,W.jsx)(J.E,{className:"h-10 w-10"}),(0,W.jsxs)("div",{className:"flex-1 flex gap-6",children:[(0,W.jsx)(J.E,{className:"w-48 h-48 rounded-xl"}),(0,W.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,W.jsx)(J.E,{className:"h-10 w-64"}),(0,W.jsx)(J.E,{className:"h-6 w-32"}),(0,W.jsx)(J.E,{className:"h-20 w-full max-w-xl"})]})]})]})});if(!ze)return(0,W.jsxs)("div",{className:"text-center py-12",children:[(0,W.jsx)(o.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,W.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Artist not found"}),(0,W.jsx)(R.$,{asChild:!0,children:(0,W.jsx)(r.N_,{to:"/admin/artists",children:"Back to Artists"})})]});const Ye=()=>{Se({title:"",description:"",coverImage:"",releaseDate:"",genre:ze.genre||"",type:"album"}),X(!0)},es=e=>{var s;pe(e),Se({title:e.title,description:e.description||"",coverImage:e.coverImage||"",releaseDate:(null===(s=e.releaseDate)||void 0===s?void 0:s.split("T")[0])||"",genre:e.genre||"",type:e.type||"album"}),ae(!0)},ss=e=>{pe(e),ie(!0)},as=e=>{pe(e),je([]),ne(!0)},ls=e=>{je(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},ts=async(e,s,a)=>{if(!e.destination)return;const t=Array.from(a),[i]=t.splice(e.source.index,1);t.splice(e.destination.index,0,i),Be(e=>(0,l.A)((0,l.A)({},e),{},{[s]:t}));const r=t.map((e,s)=>({mediaId:e.id,trackNumber:s+1}));await He.mutateAsync({albumId:s,tracks:r})},is=async e=>{let s=Qe[e.id];s||(s=await Ue(e.id)),s.length>0&&(U(s,0),T(s[0],s))},rs=(e,s)=>{T(e,s)};return(0,W.jsxs)("div",{className:"space-y-6",children:[(0,W.jsxs)("div",{className:"flex items-start gap-4",children:[(0,W.jsx)(R.$,{variant:"ghost",size:"icon",asChild:!0,children:(0,W.jsx)(r.N_,{to:"/admin/artists",children:(0,W.jsx)(m.A,{className:"h-5 w-5"})})}),(0,W.jsxs)("div",{className:"flex-1 flex flex-col md:flex-row gap-6",children:[(0,W.jsx)("div",{className:(0,Z.cn)("w-32 h-32 md:w-48 md:h-48 rounded-xl shrink-0 overflow-hidden",!ze.image&&"bg-gradient-to-br ".concat((0,Z.O3)(ze.id))),children:ze.image?(0,W.jsx)("img",{src:ze.image,alt:ze.name,className:"w-full h-full object-cover"}):(0,W.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,W.jsx)(o.A,{className:"h-16 w-16 text-white/50"})})}),(0,W.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,W.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,W.jsxs)("div",{children:[(0,W.jsx)("h1",{className:"text-3xl font-bold",children:ze.name}),(0,W.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[ze.genre&&(0,W.jsx)($.E,{variant:"secondary",children:ze.genre}),(0,W.jsxs)("span",{className:"text-muted-foreground",children:[Je.length," albums \u2022 ",ze.trackCount||Oe.length," tracks"]})]})]}),(0,W.jsxs)(q.rI,{children:[(0,W.jsx)(q.ty,{asChild:!0,children:(0,W.jsx)(R.$,{variant:"outline",size:"icon",children:(0,W.jsx)(u.A,{className:"h-5 w-5"})})}),(0,W.jsxs)(q.SQ,{align:"end",children:[(0,W.jsxs)(q._2,{onClick:()=>{Te({name:ze.name,bio:ze.bio||"",genre:ze.genre||"",image:ze.image||"",website:ze.website||""}),me(!0)},children:[(0,W.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Edit Artist"]}),ze.website&&(0,W.jsx)(q._2,{asChild:!0,children:(0,W.jsxs)("a",{href:ze.website,target:"_blank",rel:"noopener noreferrer",children:[(0,W.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Visit Website"]})}),(0,W.jsx)(q.mB,{}),(0,W.jsxs)(q._2,{onClick:()=>xe(!0),className:"text-destructive",children:[(0,W.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Delete Artist"]})]})]})]}),ze.bio&&(0,W.jsx)("p",{className:"text-muted-foreground mt-4 line-clamp-3",children:ze.bio})]})]})]}),(0,W.jsxs)(B.tU,{value:_,onValueChange:G,children:[(0,W.jsxs)("div",{className:"flex items-center justify-between",children:[(0,W.jsxs)(B.j7,{children:[(0,W.jsx)(B.Xi,{value:"albums",children:"Albums"}),(0,W.jsx)(B.Xi,{value:"tracks",children:"All Tracks"})]}),"albums"===_&&(0,W.jsxs)(R.$,{onClick:Ye,children:[(0,W.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Add Album"]})]}),(0,W.jsx)(B.av,{value:"albums",className:"space-y-6",children:Le?(0,W.jsx)("div",{className:"space-y-4",children:Array.from({length:3}).map((e,s)=>(0,W.jsx)(F.Zp,{children:(0,W.jsx)(F.Wu,{className:"p-6",children:(0,W.jsxs)("div",{className:"flex gap-4",children:[(0,W.jsx)(J.E,{className:"w-24 h-24 rounded-lg"}),(0,W.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,W.jsx)(J.E,{className:"h-6 w-48"}),(0,W.jsx)(J.E,{className:"h-4 w-32"})]})]})})},s))}):0===Je.length?(0,W.jsx)(F.Zp,{children:(0,W.jsxs)(F.Wu,{className:"text-center py-12",children:[(0,W.jsx)(j.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,W.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No albums yet"}),(0,W.jsx)("p",{className:"text-muted-foreground mb-4",children:"Create albums to organize this artist's content"}),(0,W.jsxs)(R.$,{onClick:Ye,children:[(0,W.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Create First Album"]})]})}):Je.map(e=>(0,W.jsx)(le,{album:e,albumTracksCache:Qe,fetchAlbumTracks:Ue,onEditAlbum:es,onDeleteAlbum:ss,onAssignMedia:as,onPlayAlbum:is,onPlayTrack:rs,onRemoveTrack:s=>Xe.mutate({albumId:e.id,mediaId:s.id}),onDragEnd:ts,addToast:E},e.id))}),(0,W.jsx)(B.av,{value:"tracks",children:(0,W.jsx)(F.Zp,{children:(0,W.jsx)(F.Wu,{className:"p-0",children:$e?(0,W.jsx)("div",{className:"p-4 space-y-2",children:Array.from({length:5}).map((e,s)=>(0,W.jsx)(J.E,{className:"h-12 w-full"},s))}):0===Oe.length?(0,W.jsxs)("div",{className:"text-center py-12",children:[(0,W.jsx)(v.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,W.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No tracks assigned"}),(0,W.jsx)("p",{className:"text-muted-foreground",children:"Upload media and assign it to this artist"})]}):(0,W.jsx)("div",{className:"divide-y",children:Oe.map((e,s)=>(0,W.jsxs)("div",{className:"flex items-center gap-3 p-3 hover:bg-muted/50 group",children:[(0,W.jsx)("span",{className:"w-8 text-sm text-muted-foreground text-center",children:s+1}),(0,W.jsx)("div",{className:(0,Z.cn)("w-10 h-10 rounded shrink-0","bg-gradient-to-br ".concat((0,Z.O3)(e.id))),children:e.thumbnail&&(0,W.jsx)("img",{src:e.thumbnail,alt:"",className:"w-full h-full object-cover rounded"})}),(0,W.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,W.jsx)("p",{className:"font-medium truncate",children:e.title}),(0,W.jsx)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:e.albumId?(0,W.jsx)($.E,{variant:"secondary",className:"text-xs",children:"In Album"}):(0,W.jsx)($.E,{variant:"outline",className:"text-xs",children:"Single"})})]}),(0,W.jsx)($.E,{variant:"video"===e.type?"default":"secondary",children:e.type}),(0,W.jsx)(R.$,{variant:"ghost",size:"iconSm",className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>rs(e,Oe),children:(0,W.jsx)(f.A,{className:"h-4 w-4"})})]},e.id))})})})})]}),(0,W.jsx)(O.lG,{open:K,onOpenChange:X,children:(0,W.jsxs)(O.Cf,{className:"max-w-md",children:[(0,W.jsxs)(O.c7,{children:[(0,W.jsx)(O.L3,{children:"Add New Album"}),(0,W.jsxs)(O.rr,{children:["Create a new album for ",ze.name]})]}),(0,W.jsxs)("div",{className:"space-y-4 py-4",children:[(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Title *"}),(0,W.jsx)(L.p,{value:ke.title,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{title:e.target.value})),placeholder:"Album title"})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Type"}),(0,W.jsxs)(Q.l6,{value:ke.type,onValueChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{type:e})),children:[(0,W.jsx)(Q.bq,{children:(0,W.jsx)(Q.yv,{placeholder:"Select type"})}),(0,W.jsx)(Q.gC,{children:se.map(e=>(0,W.jsx)(Q.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Genre"}),(0,W.jsx)(L.p,{value:ke.genre,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{genre:e.target.value})),placeholder:"e.g., Spirituality, Jazz"})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Description"}),(0,W.jsx)(z.T,{value:ke.description,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{description:e.target.value})),placeholder:"Album description",rows:2})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Cover Image URL"}),(0,W.jsx)(L.p,{value:ke.coverImage,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{coverImage:e.target.value})),placeholder:"https://example.com/cover.jpg"})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Release Date"}),(0,W.jsx)(L.p,{type:"date",value:ke.releaseDate,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{releaseDate:e.target.value}))})]})]}),(0,W.jsxs)(O.Es,{children:[(0,W.jsx)(R.$,{variant:"ghost",onClick:()=>X(!1),children:"Cancel"}),(0,W.jsxs)(R.$,{onClick:()=>{ke.title.trim()?_e.mutate(ke):E({message:"Album title is required",type:"error"})},disabled:_e.isLoading,children:[_e.isLoading&&(0,W.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Album"]})]})]})}),(0,W.jsx)(O.lG,{open:H,onOpenChange:ae,children:(0,W.jsxs)(O.Cf,{className:"max-w-md",children:[(0,W.jsx)(O.c7,{children:(0,W.jsx)(O.L3,{children:"Edit Album"})}),(0,W.jsxs)("div",{className:"space-y-4 py-4",children:[(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Title *"}),(0,W.jsx)(L.p,{value:ke.title,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{title:e.target.value}))})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Type"}),(0,W.jsxs)(Q.l6,{value:ke.type,onValueChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{type:e})),children:[(0,W.jsx)(Q.bq,{children:(0,W.jsx)(Q.yv,{})}),(0,W.jsx)(Q.gC,{children:se.map(e=>(0,W.jsx)(Q.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Genre"}),(0,W.jsx)(L.p,{value:ke.genre,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{genre:e.target.value}))})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Description"}),(0,W.jsx)(z.T,{value:ke.description,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{description:e.target.value})),rows:2})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Cover Image URL"}),(0,W.jsx)(L.p,{value:ke.coverImage,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{coverImage:e.target.value}))})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Release Date"}),(0,W.jsx)(L.p,{type:"date",value:ke.releaseDate,onChange:e=>Se((0,l.A)((0,l.A)({},ke),{},{releaseDate:e.target.value}))})]})]}),(0,W.jsxs)(O.Es,{children:[(0,W.jsx)(R.$,{variant:"ghost",onClick:()=>ae(!1),children:"Cancel"}),(0,W.jsxs)(R.$,{onClick:()=>{ke.title.trim()?Ge.mutate({id:he.id,data:ke}):E({message:"Album title is required",type:"error"})},disabled:Ge.isLoading,children:[Ge.isLoading&&(0,W.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})}),(0,W.jsx)(O.lG,{open:te,onOpenChange:ie,children:(0,W.jsxs)(O.Cf,{children:[(0,W.jsxs)(O.c7,{children:[(0,W.jsx)(O.L3,{children:"Delete Album"}),(0,W.jsxs)(O.rr,{children:['Are you sure you want to delete "',null===he||void 0===he?void 0:he.title,'"?']})]}),(0,W.jsx)("p",{className:"text-sm text-muted-foreground py-4",children:"The tracks in this album will not be deleted, but they will become unassigned."}),(0,W.jsxs)(O.Es,{children:[(0,W.jsx)(R.$,{variant:"ghost",onClick:()=>ie(!1),children:"Cancel"}),(0,W.jsxs)(R.$,{variant:"destructive",onClick:()=>{Ve.mutate(he.id)},disabled:Ve.isLoading,children:[Ve.isLoading&&(0,W.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete Album"]})]})]})}),(0,W.jsx)(O.lG,{open:re,onOpenChange:ne,children:(0,W.jsxs)(O.Cf,{className:"max-w-3xl max-h-[80vh] flex flex-col",children:[(0,W.jsxs)(O.c7,{children:[(0,W.jsxs)(O.L3,{children:["Add Tracks to ",null===he||void 0===he?void 0:he.title]}),(0,W.jsx)(O.rr,{children:"Select tracks from existing media or file manager"})]}),(0,W.jsxs)(B.tU,{value:ve,onValueChange:fe,className:"flex-1 flex flex-col",children:[(0,W.jsxs)(B.j7,{className:"grid w-full grid-cols-2",children:[(0,W.jsx)(B.Xi,{value:"existing",children:"Existing Media"}),(0,W.jsxs)(B.Xi,{value:"file-manager",children:[(0,W.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"From File Manager"]})]}),(0,W.jsx)(B.av,{value:"existing",className:"flex-1 overflow-y-auto py-4",children:0===Pe.length?(0,W.jsxs)("div",{className:"text-center py-8",children:[(0,W.jsx)(v.A,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),(0,W.jsx)("p",{className:"text-muted-foreground",children:"No unassigned media available"})]}):(0,W.jsx)("div",{className:"space-y-1",children:Pe.map(e=>(0,W.jsxs)("div",{onClick:()=>ls(e.id),className:(0,Z.cn)("flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors",ge.includes(e.id)?"bg-primary/20 border border-primary":"hover:bg-muted/50"),children:[(0,W.jsx)(P.S,{checked:ge.includes(e.id),onCheckedChange:()=>ls(e.id)}),(0,W.jsx)("div",{className:(0,Z.cn)("w-10 h-10 rounded shrink-0","bg-gradient-to-br ".concat((0,Z.O3)(e.id))),children:e.thumbnail&&(0,W.jsx)("img",{src:e.thumbnail,alt:"",className:"w-full h-full object-cover rounded"})}),(0,W.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,W.jsx)("p",{className:"font-medium truncate",children:e.title}),(0,W.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.subtitle||"No description"})]}),(0,W.jsx)($.E,{variant:"video"===e.type?"default":"secondary",children:e.type})]},e.id))})}),(0,W.jsx)(B.av,{value:"file-manager",className:"flex-1 py-4",children:(0,W.jsxs)("div",{className:"space-y-4",children:[(0,W.jsxs)("div",{className:"flex items-center justify-between",children:[(0,W.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select audio/video files from your file manager"}),(0,W.jsxs)(R.$,{variant:"outline",size:"sm",onClick:()=>ce(!0),children:[(0,W.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Browse Files"]})]}),0===be.length?(0,W.jsxs)("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[(0,W.jsx)(N.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-2"}),(0,W.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"No files selected"}),(0,W.jsx)(R.$,{onClick:()=>ce(!0),children:"Select Files"})]}):(0,W.jsx)("div",{className:"space-y-2 max-h-[400px] overflow-y-auto",children:be.map((e,s)=>{const a=ye[e.id]||{};return(0,W.jsx)(F.Zp,{children:(0,W.jsx)(F.Wu,{className:"p-4",children:(0,W.jsxs)("div",{className:"flex items-start gap-3",children:[(0,W.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,W.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:["video"===e.type?(0,W.jsx)(y.A,{className:"h-4 w-4 text-blue-500"}):"hls"===e.type?(0,W.jsx)(A.A,{className:"h-4 w-4 text-cyan-500"}):(0,W.jsx)(v.A,{className:"h-4 w-4 text-purple-500"}),(0,W.jsx)("p",{className:"font-medium truncate",children:e.name}),(0,W.jsx)($.E,{variant:"outline",className:"text-xs",children:e.type})]}),"hls"===e.type&&(0,W.jsxs)("div",{className:"mb-3 p-2 border rounded-lg bg-muted/50",children:[(0,W.jsx)(M.J,{className:"text-xs font-medium mb-2 block",children:"Media Type *"}),(0,W.jsxs)("div",{className:"flex gap-2",children:[(0,W.jsxs)(R.$,{variant:"video"===a.mediaType?"default":"outline",size:"sm",className:"flex-1 h-8",onClick:()=>{Ae(s=>(0,l.A)((0,l.A)({},s),{},{[e.id]:(0,l.A)((0,l.A)({},s[e.id]),{},{mediaType:"video"})}))},children:[(0,W.jsx)(y.A,{className:"h-3 w-3 mr-1"}),"Video"]}),(0,W.jsxs)(R.$,{variant:"audio"===a.mediaType?"default":"outline",size:"sm",className:"flex-1 h-8",onClick:()=>{Ae(s=>(0,l.A)((0,l.A)({},s),{},{[e.id]:(0,l.A)((0,l.A)({},s[e.id]),{},{mediaType:"audio"})}))},children:[(0,W.jsx)(v.A,{className:"h-3 w-3 mr-1"}),"Audio"]})]})]}),(0,W.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,W.jsxs)("div",{className:"space-y-1",children:[(0,W.jsxs)(M.J,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,W.jsx)(w.A,{className:"h-3 w-3"}),"Subtitle (optional)"]}),(0,W.jsx)(R.$,{variant:"outline",size:"sm",className:"w-full justify-start text-xs h-8",onClick:()=>{Ae(s=>(0,l.A)((0,l.A)({},s),{},{[e.id]:(0,l.A)((0,l.A)({},s[e.id]),{},{selectingType:"subtitle"})})),ce(!0)},children:a.subtitle?(0,W.jsx)("span",{className:"truncate",children:a.subtitle.name}):"Select subtitle"})]}),(0,W.jsxs)("div",{className:"space-y-1",children:[(0,W.jsxs)(M.J,{className:"text-xs text-muted-foreground flex items-center gap-1",children:[(0,W.jsx)(C.A,{className:"h-3 w-3"}),"Thumbnail (optional)"]}),(0,W.jsx)(R.$,{variant:"outline",size:"sm",className:"w-full justify-start text-xs h-8",onClick:()=>{Ae(s=>(0,l.A)((0,l.A)({},s),{},{[e.id]:(0,l.A)((0,l.A)({},s[e.id]),{},{selectingType:"thumbnail"})})),ce(!0)},children:a.thumbnail?(0,W.jsx)("span",{className:"truncate",children:a.thumbnail.name}):"Select thumbnail"})]})]})]}),(0,W.jsx)(R.$,{variant:"ghost",size:"iconSm",onClick:()=>{Ne(s=>s.filter(s=>s.id!==e.id)),Ae(s=>{const a=(0,l.A)({},s);return delete a[e.id],a})},children:(0,W.jsx)(k.A,{className:"h-4 w-4"})})]})})},e.id)})})]})})]}),(0,W.jsxs)(O.Es,{className:"border-t pt-4",children:[(0,W.jsx)("div",{className:"flex-1 text-sm text-muted-foreground",children:"existing"===ve?"".concat(ge.length," tracks selected"):"".concat(be.length," files selected")}),(0,W.jsx)(R.$,{variant:"ghost",onClick:()=>{ne(!1),fe("existing"),Ne([]),Ae({})},children:"Cancel"}),(0,W.jsxs)(R.$,{onClick:"existing"===ve?async()=>{if(0===ge.length)return void E({message:"Select at least one track",type:"error"});let s=(Qe[he.id]||[]).length+1;console.log("Adding tracks to album:",he.id,"tracks:",ge);try{for(const e of ge)console.log("Adding media:",e,"track number:",s),await Ke.mutateAsync({albumId:he.id,mediaId:e,trackNumber:s++});a.invalidateQueries(["album-media",he.id]),a.invalidateQueries(["artist-albums",e]),Be(e=>{const s=(0,l.A)({},e);return delete s[he.id],s}),ne(!1),pe(null),je([]),E({message:"".concat(ge.length," tracks added to album"),type:"success"})}catch(r){var t,i;console.error("Failed to add tracks:",r),E({message:(null===(t=r.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.message)||"Failed to add tracks",type:"error"})}}:async()=>{if(console.log("[CREATE MEDIA] Starting, selectedFiles:",be),0===be.length)return void E({message:"No files selected",type:"error"});const s=be.filter(e=>{var s;return"hls"===e.type&&!(null!==(s=ye[e.id])&&void 0!==s&&s.mediaType)});if(s.length>0)E({message:"Please select Video or Audio type for HLS content",type:"error"});else{Ce(!0);try{const s=be.map(e=>{var s,a;const l=ye[e.id]||{};return{path:e.path,name:e.name,type:e.type,mediaType:l.mediaType||null,subtitlePath:(null===(s=l.subtitle)||void 0===s?void 0:s.path)||null,thumbnailPath:(null===(a=l.thumbnail)||void 0===a?void 0:a.path)||null}});console.log("[CREATE MEDIA] Prepared filesData:",s);const t=localStorage.getItem("accessToken"),i=await V.A.post("".concat(ee,"/api/files/create-media"),{files:s,artistId:e,albumId:null,language:"en"},{headers:{Authorization:"Bearer ".concat(t)}});if(console.log("[CREATE MEDIA] Response:",i.data),!(i.data.success&&i.data.data.created.length>0))throw new Error("Failed to create media entries");{let s=(Qe[he.id]||[]).length+1;for(const e of i.data.data.created)await Ke.mutateAsync({albumId:he.id,mediaId:e.id,trackNumber:s++});a.invalidateQueries(["album-media",he.id]),a.invalidateQueries(["artist-albums",e]),a.invalidateQueries(["artist-media",e]),a.invalidateQueries(["admin-media"]),Be(e=>{const s=(0,l.A)({},e);return delete s[he.id],s}),ne(!1),fe("existing"),Ne([]),Ae({}),E({message:"Created and added ".concat(i.data.data.created.length," tracks"),type:"success"})}}catch(n){var t,i,r;console.error("[CREATE MEDIA] Error:",n),console.error("[CREATE MEDIA] Error response:",null===(t=n.response)||void 0===t?void 0:t.data),E({message:(null===(i=n.response)||void 0===i||null===(r=i.data)||void 0===r?void 0:r.message)||"Failed to create media from files",type:"error"})}finally{Ce(!1)}}},disabled:"existing"===ve&&0===ge.length||"file-manager"===ve&&0===be.length||we||Ke.isPending,children:[(we||Ke.isPending)&&(0,W.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),(0,W.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"existing"===ve?"Add to Album":"Create & Add to Album"]})]})]})}),(0,W.jsx)(Y,{open:de,onOpenChange:ce,onSelect:e=>{const s=Object.entries(ye).find(e=>{let[s,a]=e;return null===a||void 0===a?void 0:a.selectingType});if(s){const[a,t]=s,i=t.selectingType;e.length>0&&Ae(s=>(0,l.A)((0,l.A)({},s),{},{[a]:(0,l.A)((0,l.A)({},s[a]),{},{[i]:e[0],selectingType:null})}))}else Ne(e);ce(!1)},multiSelect:!0,allowedTypes:Object.values(ye).some(e=>"subtitle"===(null===e||void 0===e?void 0:e.selectingType))?["subtitle"]:Object.values(ye).some(e=>"thumbnail"===(null===e||void 0===e?void 0:e.selectingType))?["image"]:["audio","video","hls"],title:Object.values(ye).some(e=>"subtitle"===(null===e||void 0===e?void 0:e.selectingType))?"Select Subtitle File":Object.values(ye).some(e=>"thumbnail"===(null===e||void 0===e?void 0:e.selectingType))?"Select Thumbnail":"Select Media Files"}),(0,W.jsx)(O.lG,{open:oe,onOpenChange:me,children:(0,W.jsxs)(O.Cf,{className:"max-w-md",children:[(0,W.jsx)(O.c7,{children:(0,W.jsx)(O.L3,{children:"Edit Artist"})}),(0,W.jsxs)("div",{className:"space-y-4 py-4",children:[(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Name *"}),(0,W.jsx)(L.p,{value:Ee.name,onChange:e=>Te((0,l.A)((0,l.A)({},Ee),{},{name:e.target.value}))})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Genre"}),(0,W.jsx)(L.p,{value:Ee.genre,onChange:e=>Te((0,l.A)((0,l.A)({},Ee),{},{genre:e.target.value}))})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Biography"}),(0,W.jsx)(z.T,{value:Ee.bio,onChange:e=>Te((0,l.A)((0,l.A)({},Ee),{},{bio:e.target.value})),rows:3})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Image URL"}),(0,W.jsx)(L.p,{value:Ee.image,onChange:e=>Te((0,l.A)((0,l.A)({},Ee),{},{image:e.target.value}))})]}),(0,W.jsxs)("div",{className:"space-y-2",children:[(0,W.jsx)(M.J,{children:"Website"}),(0,W.jsx)(L.p,{value:Ee.website,onChange:e=>Te((0,l.A)((0,l.A)({},Ee),{},{website:e.target.value}))})]})]}),(0,W.jsxs)(O.Es,{children:[(0,W.jsx)(R.$,{variant:"ghost",onClick:()=>me(!1),children:"Cancel"}),(0,W.jsxs)(R.$,{onClick:()=>{Ee.name.trim()?Ze.mutate(Ee):E({message:"Artist name is required",type:"error"})},disabled:Ze.isLoading,children:[Ze.isLoading&&(0,W.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})}),(0,W.jsx)(O.lG,{open:ue,onOpenChange:xe,children:(0,W.jsxs)(O.Cf,{children:[(0,W.jsxs)(O.c7,{children:[(0,W.jsx)(O.L3,{children:"Delete Artist"}),(0,W.jsxs)(O.rr,{children:['Are you sure you want to delete "',ze.name,'"?']})]}),(0,W.jsx)("p",{className:"text-sm text-muted-foreground py-4",children:"This will delete all albums associated with this artist. Media files will not be deleted but will become unassigned."}),(0,W.jsxs)(O.Es,{children:[(0,W.jsx)(R.$,{variant:"ghost",onClick:()=>xe(!1),children:"Cancel"}),(0,W.jsxs)(R.$,{variant:"destructive",onClick:()=>{We.mutate()},disabled:We.isLoading,children:[We.isLoading&&(0,W.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete Artist"]})]})]})})]})}function le(e){var s;let{album:a,albumTracksCache:i,fetchAlbumTracks:r,onEditAlbum:n,onDeleteAlbum:d,onAssignMedia:c,onPlayAlbum:o,onPlayTrack:m,onRemoveTrack:h,onDragEnd:b,addToast:N}=e;const[A,w]=(0,t.useState)([]),[C,S]=(0,t.useState)(!0);return t.useEffect(()=>{(async()=>{S(!0);const e=await r(a.id);w(e),S(!1)})()},[a.id,r,i[a.id]]),(0,W.jsxs)(F.Zp,{children:[(0,W.jsx)(F.aR,{children:(0,W.jsxs)("div",{className:"flex items-start gap-4",children:[(0,W.jsx)("div",{className:(0,Z.cn)("w-24 h-24 rounded-lg shrink-0 overflow-hidden",!a.coverImage&&"bg-gradient-to-br ".concat((0,Z.O3)(a.id))),children:a.coverImage?(0,W.jsx)("img",{src:a.coverImage,alt:a.title,className:"w-full h-full object-cover"}):(0,W.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,W.jsx)(j.A,{className:"h-10 w-10 text-white/50"})})}),(0,W.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,W.jsxs)("div",{className:"flex items-start justify-between",children:[(0,W.jsxs)("div",{children:[(0,W.jsx)(F.ZB,{className:"text-xl",children:a.title}),(0,W.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-sm text-muted-foreground",children:[(0,W.jsx)($.E,{variant:"outline",children:(null===(s=se.find(e=>e.value===a.type))||void 0===s?void 0:s.label)||"Album"}),(0,W.jsxs)("span",{children:[a.trackCount||A.length," tracks"]}),a.releaseDate&&(0,W.jsxs)("span",{children:["\u2022 ",a.releaseDate.split("T")[0]]})]})]}),(0,W.jsxs)("div",{className:"flex items-center gap-2",children:[A.length>0&&(0,W.jsx)(R.$,{variant:"spotify",size:"icon",onClick:()=>o(a),children:(0,W.jsx)(f.A,{className:"h-5 w-5 ml-0.5"})}),(0,W.jsxs)(q.rI,{children:[(0,W.jsx)(q.ty,{asChild:!0,children:(0,W.jsx)(R.$,{variant:"ghost",size:"icon",children:(0,W.jsx)(u.A,{className:"h-5 w-5"})})}),(0,W.jsxs)(q.SQ,{align:"end",children:[(0,W.jsxs)(q._2,{onClick:()=>c(a),children:[(0,W.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Add Tracks"]}),(0,W.jsxs)(q._2,{onClick:()=>n(a),children:[(0,W.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Edit Album"]}),(0,W.jsx)(q.mB,{}),(0,W.jsxs)(q._2,{onClick:()=>d(a),className:"text-destructive",children:[(0,W.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Delete Album"]})]})]})]})]}),a.description&&(0,W.jsx)("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:a.description})]})]})}),(0,W.jsx)(F.Wu,{children:C?(0,W.jsx)("div",{className:"space-y-2",children:Array.from({length:3}).map((e,s)=>(0,W.jsx)(J.E,{className:"h-12 w-full"},s))}):0===A.length?(0,W.jsxs)("div",{className:"text-center py-6 border border-dashed rounded-lg",children:[(0,W.jsx)(v.A,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),(0,W.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"No tracks in this album"}),(0,W.jsxs)(R.$,{variant:"outline",size:"sm",onClick:()=>c(a),children:[(0,W.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Add Tracks"]})]}):(0,W.jsx)(T.JY,{onDragEnd:e=>b(e,a.id,A),children:(0,W.jsx)(T.gL,{droppableId:a.id,children:e=>(0,W.jsxs)("div",(0,l.A)((0,l.A)({ref:e.innerRef},e.droppableProps),{},{className:"space-y-1",children:[A.map((e,s)=>(0,W.jsx)(T.sx,{draggableId:e.id,index:s,children:(a,t)=>(0,W.jsxs)("div",(0,l.A)((0,l.A)({ref:a.innerRef},a.draggableProps),{},{className:(0,Z.cn)("flex items-center gap-3 p-2 rounded-lg group hover:bg-muted/50",t.isDragging&&"bg-muted shadow-lg"),children:[(0,W.jsx)("div",(0,l.A)((0,l.A)({},a.dragHandleProps),{},{className:"text-muted-foreground hover:text-foreground cursor-grab",children:(0,W.jsx)(E.A,{className:"h-4 w-4"})})),(0,W.jsx)("span",{className:"w-6 text-sm text-muted-foreground text-center",children:e.trackNumber||s+1}),(0,W.jsx)("div",{className:(0,Z.cn)("w-10 h-10 rounded shrink-0","bg-gradient-to-br ".concat((0,Z.O3)(e.id))),children:e.thumbnail&&(0,W.jsx)("img",{src:e.thumbnail,alt:"",className:"w-full h-full object-cover rounded"})}),(0,W.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,W.jsx)("p",{className:"font-medium truncate",children:e.title}),(0,W.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:["video"===e.type?(0,W.jsx)(y.A,{className:"h-3 w-3"}):(0,W.jsx)(v.A,{className:"h-3 w-3"}),(0,W.jsx)("span",{children:e.type})]})]}),(0,W.jsxs)("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,W.jsx)(R.$,{variant:"ghost",size:"iconSm",onClick:()=>m(e,A),children:(0,W.jsx)(f.A,{className:"h-4 w-4"})}),(0,W.jsx)(R.$,{variant:"ghost",size:"iconSm",onClick:()=>h(e),children:(0,W.jsx)(k.A,{className:"h-4 w-4"})})]})]}))},e.id)),e.placeholder]}))})})})]})}},65005:(e,s,a)=>{a.d(s,{S:()=>m});var l=a(27051),t=a(53986),i=a(65043),r=a(76622),n=a(36210),d=a(99766),c=a(70579);const o=["className"],m=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,o);return(0,c.jsx)(r.bL,(0,l.A)((0,l.A)({ref:s,className:(0,d.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a)},i),{},{children:(0,c.jsx)(r.C1,{className:(0,d.cn)("flex items-center justify-center text-current"),children:(0,c.jsx)(n.A,{className:"h-4 w-4"})})}))});m.displayName=r.bL.displayName},84370:(e,s,a)=>{a.d(s,{bq:()=>N,eb:()=>C,gC:()=>w,l6:()=>f,yv:()=>b});var l=a(27051),t=a(53986),i=a(65043),r=a(22095),n=a(36210),d=a(92382),c=a(15711),o=a(99766),m=a(70579);const u=["className","children"],x=["className"],h=["className"],p=["className","children","position"],g=["className"],j=["className","children"],v=["className"],f=r.bL,b=(r.YJ,r.WT),N=i.forwardRef((e,s)=>{let{className:a,children:i}=e,n=(0,t.A)(e,u);return(0,m.jsxs)(r.l9,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a)},n),{},{children:[i,(0,m.jsx)(r.In,{asChild:!0,children:(0,m.jsx)(d.A,{className:"h-4 w-4 opacity-50"})})]}))});N.displayName=r.l9.displayName;const y=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,x);return(0,m.jsx)(r.PP,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a)},i),{},{children:(0,m.jsx)(c.A,{className:"h-4 w-4"})}))});y.displayName=r.PP.displayName;const A=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,h);return(0,m.jsx)(r.wn,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a)},i),{},{children:(0,m.jsx)(d.A,{className:"h-4 w-4"})}))});A.displayName=r.wn.displayName;const w=i.forwardRef((e,s)=>{let{className:a,children:i,position:n="popper"}=e,d=(0,t.A)(e,p);return(0,m.jsx)(r.ZL,{children:(0,m.jsxs)(r.UC,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n},d),{},{children:[(0,m.jsx)(y,{}),(0,m.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,m.jsx)(A,{})]}))})});w.displayName=r.UC.displayName;i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,g);return(0,m.jsx)(r.JU,(0,l.A)({ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a)},i))}).displayName=r.JU.displayName;const C=i.forwardRef((e,s)=>{let{className:a,children:i}=e,d=(0,t.A)(e,j);return(0,m.jsxs)(r.q7,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a)},d),{},{children:[(0,m.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,m.jsx)(r.VF,{children:(0,m.jsx)(n.A,{className:"h-4 w-4"})})}),(0,m.jsx)(r.p4,{children:i})]}))});C.displayName=r.q7.displayName;i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,v);return(0,m.jsx)(r.wv,(0,l.A)({ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a)},i))}).displayName=r.wv.displayName},91140:(e,s,a)=>{a.d(s,{BT:()=>j,Wu:()=>v,ZB:()=>g,Zp:()=>h,aR:()=>p});var l=a(27051),t=a(53986),i=a(65043),r=a(99766),n=a(70579);const d=["className"],c=["className"],o=["className","children"],m=["className"],u=["className"],x=["className"],h=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,d);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-300",a)},i))});h.displayName="Card";const p=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,c);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a)},i))});p.displayName="CardHeader";const g=i.forwardRef((e,s)=>{let{className:a,children:i}=e,d=(0,t.A)(e,o);return(0,n.jsx)("h3",(0,l.A)((0,l.A)({ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a)},d),{},{children:i}))});g.displayName="CardTitle";const j=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,m);return(0,n.jsx)("p",(0,l.A)({ref:s,className:(0,r.cn)("text-sm text-muted-foreground",a)},i))});j.displayName="CardDescription";const v=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,u);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("p-6 pt-0",a)},i))});v.displayName="CardContent";i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,x);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",a)},i))}).displayName="CardFooter"}}]);
//# sourceMappingURL=9803.14e1f6c6.chunk.js.map