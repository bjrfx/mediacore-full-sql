"use strict";(self.webpackChunkmediacore_frontend=self.webpackChunkmediacore_frontend||[]).push([[366],{31555:(e,s,a)=>{a.d(s,{E:()=>d});var l=a(27051),i=a(53986),t=(a(65043),a(99766)),r=a(70579);const n=["className"];function d(e){let{className:s}=e,a=(0,i.A)(e,n);return(0,r.jsx)("div",(0,l.A)({className:(0,t.cn)("animate-pulse rounded-md bg-muted",s)},a))}},82353:(e,s,a)=>{a.d(s,{$v:()=>E,EO:()=>b,Lt:()=>f,Rx:()=>C,Zr:()=>k,ck:()=>y,r7:()=>A,wd:()=>w});var l=a(27051),i=a(53986),t=a(65043),r=a(74796),n=a(99766),d=a(13390),c=a(70579);const o=["className"],m=["className"],x=["className"],u=["className"],h=["className"],p=["className"],j=["className"],N=["className"],f=r.bL,g=(r.l9,r.ZL),v=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,o);return(0,c.jsx)(r.hJ,(0,l.A)((0,l.A)({className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a)},t),{},{ref:s}))});v.displayName=r.hJ.displayName;const b=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,m);return(0,c.jsxs)(g,{children:[(0,c.jsx)(v,{}),(0,c.jsx)(r.UC,(0,l.A)({ref:s,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a)},t))]})});b.displayName=r.UC.displayName;const w=e=>{let{className:s}=e,a=(0,i.A)(e,x);return(0,c.jsx)("div",(0,l.A)({className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",s)},a))};w.displayName="AlertDialogHeader";const y=e=>{let{className:s}=e,a=(0,i.A)(e,u);return(0,c.jsx)("div",(0,l.A)({className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s)},a))};y.displayName="AlertDialogFooter";const A=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,h);return(0,c.jsx)(r.hE,(0,l.A)({ref:s,className:(0,n.cn)("text-lg font-semibold",a)},t))});A.displayName=r.hE.displayName;const E=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,p);return(0,c.jsx)(r.VY,(0,l.A)({ref:s,className:(0,n.cn)("text-sm text-muted-foreground",a)},t))});E.displayName=r.VY.displayName;const C=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,j);return(0,c.jsx)(r.rc,(0,l.A)({ref:s,className:(0,n.cn)((0,d.r)(),a)},t))});C.displayName=r.rc.displayName;const k=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,N);return(0,c.jsx)(r.ZD,(0,l.A)({ref:s,className:(0,n.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",a)},t))});k.displayName=r.ZD.displayName},84370:(e,s,a)=>{a.d(s,{bq:()=>b,eb:()=>E,gC:()=>A,l6:()=>g,yv:()=>v});var l=a(27051),i=a(53986),t=a(65043),r=a(22095),n=a(36210),d=a(92382),c=a(15711),o=a(99766),m=a(70579);const x=["className","children"],u=["className"],h=["className"],p=["className","children","position"],j=["className"],N=["className","children"],f=["className"],g=r.bL,v=(r.YJ,r.WT),b=t.forwardRef((e,s)=>{let{className:a,children:t}=e,n=(0,i.A)(e,x);return(0,m.jsxs)(r.l9,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a)},n),{},{children:[t,(0,m.jsx)(r.In,{asChild:!0,children:(0,m.jsx)(d.A,{className:"h-4 w-4 opacity-50"})})]}))});b.displayName=r.l9.displayName;const w=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,u);return(0,m.jsx)(r.PP,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a)},t),{},{children:(0,m.jsx)(c.A,{className:"h-4 w-4"})}))});w.displayName=r.PP.displayName;const y=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,h);return(0,m.jsx)(r.wn,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a)},t),{},{children:(0,m.jsx)(d.A,{className:"h-4 w-4"})}))});y.displayName=r.wn.displayName;const A=t.forwardRef((e,s)=>{let{className:a,children:t,position:n="popper"}=e,d=(0,i.A)(e,p);return(0,m.jsx)(r.ZL,{children:(0,m.jsxs)(r.UC,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n},d),{},{children:[(0,m.jsx)(w,{}),(0,m.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),(0,m.jsx)(y,{})]}))})});A.displayName=r.UC.displayName;t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,j);return(0,m.jsx)(r.JU,(0,l.A)({ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a)},t))}).displayName=r.JU.displayName;const E=t.forwardRef((e,s)=>{let{className:a,children:t}=e,d=(0,i.A)(e,N);return(0,m.jsxs)(r.q7,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a)},d),{},{children:[(0,m.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,m.jsx)(r.VF,{children:(0,m.jsx)(n.A,{className:"h-4 w-4"})})}),(0,m.jsx)(r.p4,{children:t})]}))});E.displayName=r.q7.displayName;t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,f);return(0,m.jsx)(r.wv,(0,l.A)({ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a)},t))}).displayName=r.wv.displayName},91140:(e,s,a)=>{a.d(s,{BT:()=>N,Wu:()=>f,ZB:()=>j,Zp:()=>h,aR:()=>p});var l=a(27051),i=a(53986),t=a(65043),r=a(99766),n=a(70579);const d=["className"],c=["className"],o=["className","children"],m=["className"],x=["className"],u=["className"],h=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,d);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-300",a)},t))});h.displayName="Card";const p=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,c);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a)},t))});p.displayName="CardHeader";const j=t.forwardRef((e,s)=>{let{className:a,children:t}=e,d=(0,i.A)(e,o);return(0,n.jsx)("h3",(0,l.A)((0,l.A)({ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a)},d),{},{children:t}))});j.displayName="CardTitle";const N=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,m);return(0,n.jsx)("p",(0,l.A)({ref:s,className:(0,r.cn)("text-sm text-muted-foreground",a)},t))});N.displayName="CardDescription";const f=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,x);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("p-6 pt-0",a)},t))});f.displayName="CardContent";t.forwardRef((e,s)=>{let{className:a}=e,t=(0,i.A)(e,u);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",a)},t))}).displayName="CardFooter"},91366:(e,s,a)=>{a.r(s),a.d(s,{default:()=>Q});var l=a(65043),i=a(12265),t=a(63248),r=a(47097),n=a(81228),d=a(51861),c=a(53639),o=a(75088),m=a(86376),x=a(72629),u=a(55731),h=a(35327),p=a(28006),j=a(63172),N=a(18992),f=a(50516),g=a(39292),v=a(78384),b=a(84025),w=a(42489),y=a(46963),A=a(63944),E=a(9855),C=a(20254),k=a(746),U=a(14459),R=a(7118),S=a(81885),P=a(56099),F=a(66305),T=a(18717),I=a(91140),L=a(92264),M=a(13390),D=a(63972),_=a(5949),O=a(31555),Z=a(17484),V=a(65598),q=a(82353),B=a(84370),$=a(99766),z=a(36604),W=a(22662),J=a(70579);function Q(){var e,s,a,Q,Y;const K=(0,t.jE)(),{addToast:G}=(0,T.j_)(),[H,X]=(0,l.useState)(""),[ee,se]=(0,l.useState)(null),[ae,le]=(0,l.useState)(!1),[ie,te]=(0,l.useState)(!1),[re,ne]=(0,l.useState)(!1),[de,ce]=(0,l.useState)(!1),[oe,me]=(0,l.useState)(null),[xe,ue]=(0,l.useState)(null),[he,pe]=(0,l.useState)(null),[je,Ne]=(0,l.useState)(null),{data:fe,isLoading:ge,refetch:ve,isRefetching:be,error:we}=(0,i.I)({queryKey:["admin","users"],queryFn:()=>F.ic.getUsers(),retry:1}),{data:ye,isLoading:Ae,refetch:Ee}=(0,i.I)({queryKey:["admin","users","online"],queryFn:async()=>{try{return await F.ic.getOnlineUsers()}catch(we){return console.debug("[Online Users] Endpoint not available:",we.message),{data:{count:0,users:[]}}}},refetchInterval:3e4,retry:!1}),Ce=(null===fe||void 0===fe||null===(e=fe.data)||void 0===e?void 0:e.users)||(null===fe||void 0===fe?void 0:fe.data)||[],ke=(null===ye||void 0===ye||null===(s=ye.data)||void 0===s?void 0:s.users)||(null===ye||void 0===ye?void 0:ye.users)||[],Ue=(null===ye||void 0===ye||null===(a=ye.data)||void 0===a?void 0:a.count)||(null===ye||void 0===ye?void 0:ye.count)||ke.length,Re=new Set(ke.map(e=>e.uid)),Se=(0,r.n)({mutationFn:e=>{let{uid:s,role:a}=e;return F.ic.updateUserRole(s,a)},onSuccess:(e,s)=>{K.invalidateQueries(["admin","users"]),ne(!1),ue(null),G({message:"User role updated to ".concat(s.role),type:"success"})},onError:e=>{var s,a;G({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to update user role",type:"error"})}}),Pe=(0,r.n)({mutationFn:e=>{let{uid:s,disabled:a}=e;return F.ic.updateUserStatus(s,a)},onSuccess:(e,s)=>{K.invalidateQueries(["admin","users"]),G({message:"User ".concat(s.disabled?"disabled":"enabled"," successfully"),type:"success"})},onError:e=>{var s,a;G({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to update user status",type:"error"})}}),Fe=(0,r.n)({mutationFn:e=>F.ic.deleteUser(e),onSuccess:()=>{K.invalidateQueries(["admin","users"]),te(!1),me(null),G({message:"User deleted successfully",type:"success"})},onError:e=>{var s,a;G({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to delete user",type:"error"})}}),Te=(0,r.n)({mutationFn:e=>{let{uid:s,subscriptionTier:a}=e;return console.log("[Admin] Updating subscription:",{uid:s,subscriptionTier:a}),F.ic.updateUserSubscription(s,a)},onSuccess:(e,s)=>{console.log("[Admin] Subscription updated successfully:",e),K.invalidateQueries(["admin","users"]),ce(!1),pe(null),Ne(null),G({message:"Subscription updated to ".concat(W.rI[s.subscriptionTier]),type:"success"})},onError:e=>{var s,a;console.error("[Admin] Subscription update failed:",e),G({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||e.message||"Failed to update subscription. Make sure the backend API endpoint exists.",type:"error"})}}),Ie=Ce.filter(e=>{var s,a,l;const i=H.toLowerCase();return(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(i))||(null===(a=e.displayName)||void 0===a?void 0:a.toLowerCase().includes(i))||(null===(l=e.uid)||void 0===l?void 0:l.toLowerCase().includes(i))}),Le=Ce.filter(e=>{var s;return"admin"===e.role||(null===(s=e.customClaims)||void 0===s?void 0:s.admin)}).length,Me=e=>{ue(e),ne(!0)},De=e=>{pe(e),Ne(e.subscriptionTier||W.i9.FREE),ce(!0)},_e=e=>{Pe.mutate({uid:e.uid,disabled:!e.disabled})},Oe=e=>{var s;return"admin"===e.role||(null===(s=e.customClaims)||void 0===s?void 0:s.admin)},Ze=e=>{var s;return e.subscriptionTier||(null===(s=e.customClaims)||void 0===s?void 0:s.subscriptionTier)||W.i9.FREE},Ve=e=>{switch(e){case W.i9.ENTERPRISE:return(0,J.jsx)(c.A,{className:"h-4 w-4"});case W.i9.PREMIUM_PLUS:return(0,J.jsx)(x.A,{className:"h-4 w-4"});case W.i9.PREMIUM:return(0,J.jsx)(A.A,{className:"h-4 w-4"});default:return(0,J.jsx)(P.A,{className:"h-4 w-4"})}},qe=e=>{const s=W.eJ[e]||W.eJ[W.i9.FREE];return(0,J.jsxs)(_.E,{className:(0,$.cn)("gap-1",s),children:[Ve(e),W.rI[e]||"Free"]})},Be=(e,s)=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):(null===s||void 0===s?void 0:s.charAt(0).toUpperCase())||"?",$e=e=>{if(!e)return"Never";const s=new Date-new Date(e),a=Math.floor(s/6e4),l=Math.floor(s/36e5),i=Math.floor(s/864e5);return a<60?"".concat(a,"m ago"):l<24?"".concat(l,"h ago"):i<7?"".concat(i,"d ago"):(0,$.Yq)(e)};var ze,We;return we?(0,J.jsxs)("div",{className:"space-y-6",children:[(0,J.jsxs)("div",{children:[(0,J.jsx)("h2",{className:"text-2xl font-bold",children:"Users"}),(0,J.jsx)("p",{className:"text-muted-foreground",children:"View and manage Firebase authenticated users"})]}),(0,J.jsx)(I.Zp,{children:(0,J.jsxs)(I.Wu,{className:"py-12 text-center",children:[(0,J.jsx)(d.A,{className:"h-12 w-12 mx-auto text-destructive mb-4"}),(0,J.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Failed to load users"}),(0,J.jsx)("p",{className:"text-muted-foreground mb-4",children:(null===(ze=we.response)||void 0===ze||null===(We=ze.data)||void 0===We?void 0:We.message)||we.message||"An error occurred"}),(0,J.jsxs)(M.$,{onClick:()=>ve(),children:[(0,J.jsx)(f.A,{className:"h-4 w-4 mr-2"}),"Try Again"]})]})})]}):(0,J.jsxs)("div",{className:"space-y-6",children:[(0,J.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,J.jsxs)("div",{children:[(0,J.jsx)("h2",{className:"text-2xl font-bold",children:"Users"}),(0,J.jsx)("p",{className:"text-muted-foreground",children:"View and manage Firebase authenticated users"})]}),(0,J.jsxs)(M.$,{variant:"outline",onClick:()=>ve(),disabled:be,children:[(0,J.jsx)(f.A,{className:(0,$.cn)("h-4 w-4 mr-2",be&&"animate-spin")}),"Refresh"]})]}),(0,J.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4",children:[{title:"Online Now",value:Ue,icon:S.A,color:"text-green-500",pulse:!0},{title:"Total Users",value:Ce.length,icon:R.A,color:"text-blue-500"},{title:"Admins",value:Le,icon:x.A,color:"text-yellow-500"},{title:"Verified",value:Ce.filter(e=>e.emailVerified).length,icon:C.A,color:"text-green-500"},{title:"Unverified",value:Ce.filter(e=>!e.emailVerified).length,icon:k.A,color:"text-orange-500"},{title:"Disabled",value:Ce.filter(e=>e.disabled).length,icon:w.A,color:"text-red-500"}].map((e,s)=>(0,J.jsx)(n.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*s},children:(0,J.jsx)(I.Zp,{children:(0,J.jsx)(I.Wu,{className:"p-4",children:ge?(0,J.jsx)(O.E,{className:"h-16"}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,J.jsx)(e.icon,{className:(0,$.cn)("h-4 w-4",e.color,e.pulse&&"animate-pulse")}),(0,J.jsx)("span",{className:"text-sm text-muted-foreground",children:e.title})]}),(0,J.jsx)("p",{className:"text-2xl font-bold",children:e.value})]})})})},e.title))}),ke.length>0&&(0,J.jsxs)(I.Zp,{className:"border-green-500/30 bg-green-500/5",children:[(0,J.jsx)(I.aR,{className:"pb-3",children:(0,J.jsxs)("div",{className:"flex items-center justify-between",children:[(0,J.jsxs)(I.ZB,{className:"flex items-center gap-2 text-lg",children:[(0,J.jsxs)("div",{className:"relative",children:[(0,J.jsx)(S.A,{className:"h-5 w-5 text-green-500"}),(0,J.jsx)("span",{className:"absolute -top-1 -right-1 h-2.5 w-2.5 bg-green-500 rounded-full animate-ping"}),(0,J.jsx)("span",{className:"absolute -top-1 -right-1 h-2.5 w-2.5 bg-green-500 rounded-full"})]}),(0,J.jsx)("span",{children:"Online Users"}),(0,J.jsx)(_.E,{variant:"secondary",className:"ml-2 bg-green-500/20 text-green-500",children:Ue})]}),(0,J.jsx)(M.$,{variant:"ghost",size:"sm",onClick:()=>Ee(),disabled:Ae,children:(0,J.jsx)(f.A,{className:(0,$.cn)("h-4 w-4",Ae&&"animate-spin")})})]})}),(0,J.jsx)(I.Wu,{children:(0,J.jsx)("div",{className:"flex flex-wrap gap-3",children:ke.map(e=>{var s;return(0,J.jsxs)(n.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"flex items-center gap-2 bg-background rounded-full pl-1 pr-3 py-1 border shadow-sm",children:[(0,J.jsxs)("div",{className:"relative",children:[(0,J.jsxs)(D.eu,{className:"h-7 w-7",children:[(0,J.jsx)(D.BK,{src:e.photoURL,alt:e.displayName}),(0,J.jsx)(D.q5,{className:"text-xs",children:Be(e.displayName,e.email)})]}),(0,J.jsx)("span",{className:"absolute -bottom-0.5 -right-0.5 h-2.5 w-2.5 bg-green-500 rounded-full border-2 border-background"})]}),(0,J.jsxs)("div",{className:"flex flex-col",children:[(0,J.jsx)("span",{className:"text-sm font-medium leading-tight",children:e.displayName||(null===(s=e.email)||void 0===s?void 0:s.split("@")[0])||"User"}),e.lastSeen&&(0,J.jsxs)("span",{className:"text-[10px] text-muted-foreground leading-tight",children:["Active ",$e(e.lastSeen)]})]})]},e.uid)})})})]}),(0,J.jsx)(I.Zp,{children:(0,J.jsx)(I.Wu,{className:"p-4",children:(0,J.jsxs)("div",{className:"relative",children:[(0,J.jsx)(g.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,J.jsx)(L.p,{placeholder:"Search by name, email, or UID...",value:H,onChange:e=>X(e.target.value),className:"pl-10"})]})})}),(0,J.jsxs)(I.Zp,{children:[(0,J.jsx)(I.aR,{children:(0,J.jsxs)(I.ZB,{children:["Users (",Ie.length,")"]})}),(0,J.jsx)(I.Wu,{className:"p-0",children:(0,J.jsx)(z.F,{className:"h-[500px]",children:ge?(0,J.jsx)("div",{className:"space-y-4 p-4",children:Array.from({length:5}).map((e,s)=>(0,J.jsxs)("div",{className:"flex items-center gap-4",children:[(0,J.jsx)(O.E,{className:"h-10 w-10 rounded-full"}),(0,J.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,J.jsx)(O.E,{className:"h-4 w-1/3"}),(0,J.jsx)(O.E,{className:"h-3 w-1/4"})]})]},s))}):0===Ie.length?(0,J.jsxs)("div",{className:"text-center py-12",children:[(0,J.jsx)(R.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,J.jsx)("p",{className:"text-muted-foreground",children:H?"No users found matching your search":"No users registered yet"})]}):(0,J.jsx)("div",{className:"divide-y divide-border",children:Ie.map((e,s)=>{var a;return(0,J.jsxs)(n.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.02*s},className:"flex items-center gap-4 p-4 hover:bg-muted/50 transition-colors",children:[(0,J.jsxs)("div",{className:"relative",children:[(0,J.jsxs)(D.eu,{className:"h-10 w-10",children:[(0,J.jsx)(D.BK,{src:e.photoURL,alt:e.displayName}),(0,J.jsx)(D.q5,{children:Be(e.displayName,e.email)})]}),Re.has(e.uid)&&(0,J.jsx)("span",{className:"absolute -bottom-0.5 -right-0.5 h-3 w-3 bg-green-500 rounded-full border-2 border-background"})]}),(0,J.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,J.jsxs)("div",{className:"flex items-center gap-2",children:[(0,J.jsx)("p",{className:"font-medium truncate",children:e.displayName||"Unknown"}),Oe(e)&&(0,J.jsx)(x.A,{className:"h-4 w-4 text-yellow-500"})]}),(0,J.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:e.email})]}),(0,J.jsxs)("div",{className:"hidden md:flex items-center gap-2",children:[qe(Ze(e)),Oe(e)?(0,J.jsx)(_.E,{className:"bg-yellow-500/20 text-yellow-500 border-yellow-500/30",children:"Admin"}):(0,J.jsx)(_.E,{variant:"secondary",children:"User"}),e.emailVerified?(0,J.jsx)(_.E,{variant:"success",className:"text-xs",children:"Verified"}):(0,J.jsx)(_.E,{variant:"outline",className:"text-xs",children:"Unverified"}),e.disabled&&(0,J.jsx)(_.E,{variant:"destructive",className:"text-xs",children:"Disabled"})]}),(0,J.jsx)("div",{className:"hidden lg:flex flex-col items-end text-xs text-muted-foreground",children:(0,J.jsxs)("span",{className:"flex items-center gap-1",children:[(0,J.jsx)(o.A,{className:"h-3 w-3"}),$e(null===(a=e.metadata)||void 0===a?void 0:a.lastSignInTime)]})}),(0,J.jsxs)(Z.rI,{children:[(0,J.jsx)(Z.ty,{asChild:!0,children:(0,J.jsx)(M.$,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,J.jsx)(N.A,{className:"h-4 w-4"})})}),(0,J.jsxs)(Z.SQ,{align:"end",className:"w-56",children:[(0,J.jsxs)(Z._2,{onClick:()=>(e=>{se(e),le(!0)})(e),children:[(0,J.jsx)(U.A,{className:"h-4 w-4 mr-2"}),"View Details"]}),(0,J.jsx)(Z.mB,{}),(0,J.jsx)(Z.lp,{children:"Subscription"}),(0,J.jsxs)(Z._2,{onClick:()=>De(e),children:[(0,J.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Change Subscription"]}),(0,J.jsxs)(Z.lv,{children:[(0,J.jsxs)(Z.nV,{children:[(0,J.jsx)(A.A,{className:"h-4 w-4 mr-2"}),"Quick Set Tier"]}),(0,J.jsxs)(Z.M5,{children:[(0,J.jsxs)(Z._2,{onClick:()=>Te.mutate({uid:e.uid,subscriptionTier:W.i9.FREE}),children:[(0,J.jsx)(P.A,{className:"h-4 w-4 mr-2"}),"Free"]}),(0,J.jsxs)(Z._2,{onClick:()=>Te.mutate({uid:e.uid,subscriptionTier:W.i9.PREMIUM}),children:[(0,J.jsx)(A.A,{className:"h-4 w-4 mr-2 text-purple-500"}),"Premium"]}),(0,J.jsxs)(Z._2,{onClick:()=>Te.mutate({uid:e.uid,subscriptionTier:W.i9.PREMIUM_PLUS}),children:[(0,J.jsx)(x.A,{className:"h-4 w-4 mr-2 text-amber-500"}),"Premium Plus"]}),(0,J.jsxs)(Z._2,{onClick:()=>Te.mutate({uid:e.uid,subscriptionTier:W.i9.ENTERPRISE}),children:[(0,J.jsx)(c.A,{className:"h-4 w-4 mr-2 text-emerald-500"}),"Enterprise"]})]})]}),(0,J.jsx)(Z.mB,{}),(0,J.jsx)(Z.lp,{children:"Role & Status"}),(0,J.jsx)(Z._2,{onClick:()=>Me(e),children:Oe(e)?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(b.A,{className:"h-4 w-4 mr-2"}),"Remove Admin"]}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(v.A,{className:"h-4 w-4 mr-2"}),"Make Admin"]})}),(0,J.jsx)(Z._2,{onClick:()=>_e(e),children:e.disabled?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(C.A,{className:"h-4 w-4 mr-2"}),"Enable User"]}):(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(k.A,{className:"h-4 w-4 mr-2"}),"Disable User"]})}),(0,J.jsx)(Z.mB,{}),(0,J.jsx)(Z._2,{onClick:()=>navigator.clipboard.writeText(e.uid),children:"Copy UID"}),(0,J.jsx)(Z._2,{onClick:()=>navigator.clipboard.writeText(e.email),children:"Copy Email"}),(0,J.jsx)(Z.mB,{}),(0,J.jsxs)(Z._2,{className:"text-destructive focus:text-destructive",onClick:()=>(e=>{me(e),te(!0)})(e),children:[(0,J.jsx)(E.A,{className:"h-4 w-4 mr-2"}),"Delete User"]})]})]})]},e.uid)})})})})]}),(0,J.jsx)(V.lG,{open:ae,onOpenChange:le,children:(0,J.jsxs)(V.Cf,{className:"max-w-md",children:[(0,J.jsxs)(V.c7,{children:[(0,J.jsx)(V.L3,{children:"User Details"}),(0,J.jsx)(V.rr,{children:"Detailed information about this user"})]}),ee&&(0,J.jsxs)("div",{className:"space-y-6",children:[(0,J.jsxs)("div",{className:"flex items-center gap-4",children:[(0,J.jsxs)(D.eu,{className:"h-16 w-16",children:[(0,J.jsx)(D.BK,{src:ee.photoURL,alt:ee.displayName}),(0,J.jsx)(D.q5,{className:"text-xl",children:Be(ee.displayName,ee.email)})]}),(0,J.jsxs)("div",{children:[(0,J.jsxs)("div",{className:"flex items-center gap-2",children:[(0,J.jsx)("p",{className:"text-lg font-semibold",children:ee.displayName||"Unknown"}),Oe(ee)&&(0,J.jsx)(x.A,{className:"h-5 w-5 text-yellow-500"})]}),(0,J.jsxs)("div",{className:"flex gap-2 mt-1",children:[Oe(ee)?(0,J.jsx)(_.E,{className:"bg-yellow-500/20 text-yellow-500 border-yellow-500/30",children:"Admin"}):(0,J.jsx)(_.E,{variant:"secondary",children:"User"}),ee.emailVerified?(0,J.jsx)(_.E,{variant:"success",className:"text-xs",children:"Verified"}):(0,J.jsx)(_.E,{variant:"outline",className:"text-xs",children:"Unverified"}),ee.disabled&&(0,J.jsx)(_.E,{variant:"destructive",className:"text-xs",children:"Disabled"})]})]})]}),(0,J.jsxs)("div",{className:"space-y-4",children:[(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Email"}),(0,J.jsxs)("p",{className:"flex items-center gap-2 mt-1",children:[(0,J.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"}),ee.email]})]}),(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"UID"}),(0,J.jsx)("p",{className:"mt-1 font-mono text-sm break-all",children:ee.uid})]}),(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Role"}),(0,J.jsx)("p",{className:"mt-1",children:Oe(ee)?"Administrator":"Regular User"})]}),(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Subscription"}),(0,J.jsx)("div",{className:"mt-1",children:qe(Ze(ee))})]}),(0,J.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Created"}),(0,J.jsx)("p",{className:"mt-1 text-sm",children:(0,$.Yq)((null===(Q=ee.metadata)||void 0===Q?void 0:Q.creationTime)||ee.createdAt||ee.creationTime)})]}),(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Last Sign In"}),(0,J.jsx)("p",{className:"mt-1 text-sm",children:(0,$.Yq)((null===(Y=ee.metadata)||void 0===Y?void 0:Y.lastSignInTime)||ee.lastSignInTime||ee.lastLoginAt)})]})]}),ee.providerData&&(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Sign-in Providers"}),(0,J.jsx)("div",{className:"flex gap-2 mt-2",children:ee.providerData.map(e=>(0,J.jsx)(_.E,{variant:"secondary",children:e.providerId.replace(".com","")},e.providerId))})]}),(()=>{const e=(s=ee.uid,ke.find(e=>e.uid===s)||null);var s;const a=Re.has(ee.uid),l=null!==e&&void 0!==e&&e.userAgent?(e=>{if(!e)return{device:"Unknown",browser:"Unknown"};let s="Desktop",a="Unknown";return/iPhone/i.test(e)?s="iPhone":/iPad/i.test(e)?s="iPad":/Android/i.test(e)?s=/Mobile/i.test(e)?"Android Phone":"Android Tablet":/Macintosh/i.test(e)?s="Mac":/Windows/i.test(e)?s="Windows PC":/Linux/i.test(e)&&(s="Linux"),/Edg/i.test(e)?a="Edge":/Chrome/i.test(e)?a="Chrome":/Safari/i.test(e)?a="Safari":/Firefox/i.test(e)?a="Firefox":/Opera|OPR/i.test(e)&&(a="Opera"),{device:s,browser:a}})(e.userAgent):null;return(0,J.jsxs)("div",{className:"space-y-3 pt-3 border-t",children:[(0,J.jsxs)("div",{className:"flex items-center justify-between",children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Status"}),a?(0,J.jsxs)(_.E,{className:"bg-green-500/20 text-green-500 border-green-500/30 gap-1",children:[(0,J.jsx)("span",{className:"h-2 w-2 bg-green-500 rounded-full animate-pulse"}),"Online"]}):(0,J.jsxs)(_.E,{variant:"secondary",className:"gap-1",children:[(0,J.jsx)("span",{className:"h-2 w-2 bg-gray-400 rounded-full"}),"Offline"]})]}),e?(0,J.jsxs)(J.Fragment,{children:[(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"IP Address"}),(0,J.jsxs)("p",{className:"flex items-center gap-2 mt-1 font-mono text-sm",children:[(0,J.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"}),e.ipAddress||"Unknown"]})]}),e.location&&(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Location"}),(0,J.jsxs)("p",{className:"flex items-center gap-2 mt-1 text-sm",children:[(0,J.jsx)(p.A,{className:"h-4 w-4 text-muted-foreground"}),e.location]})]}),l&&(0,J.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Device"}),(0,J.jsxs)("p",{className:"flex items-center gap-2 mt-1 text-sm",children:[l.device.includes("Phone")||l.device.includes("iPhone")?(0,J.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}):(0,J.jsx)(j.A,{className:"h-4 w-4 text-muted-foreground"}),l.device]})]}),(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Browser"}),(0,J.jsxs)("p",{className:"flex items-center gap-2 mt-1 text-sm",children:[(0,J.jsx)(u.A,{className:"h-4 w-4 text-muted-foreground"}),l.browser]})]})]}),(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:"Last Active"}),(0,J.jsxs)("p",{className:"flex items-center gap-2 mt-1 text-sm",children:[(0,J.jsx)(o.A,{className:"h-4 w-4 text-muted-foreground"}),$e(e.lastSeen)]})]})]}):(0,J.jsx)("p",{className:"text-sm text-muted-foreground",children:"No recent session data available"})]})})()]}),(0,J.jsxs)("div",{className:"flex gap-2 pt-4 border-t",children:[(0,J.jsxs)(M.$,{variant:"outline",className:"flex-1",onClick:()=>De(ee),children:[(0,J.jsx)(m.A,{className:"h-4 w-4 mr-2"}),"Subscription"]}),(0,J.jsx)(M.$,{variant:"outline",className:"flex-1",onClick:()=>Me(ee),children:Oe(ee)?"Remove Admin":"Make Admin"})]}),(0,J.jsx)("div",{className:"flex gap-2",children:(0,J.jsx)(M.$,{variant:"outline",className:"flex-1",onClick:()=>{_e(ee),le(!1)},children:ee.disabled?"Enable":"Disable"})})]})]})}),(0,J.jsx)(q.Lt,{open:re,onOpenChange:ne,children:(0,J.jsxs)(q.EO,{children:[(0,J.jsxs)(q.wd,{children:[(0,J.jsx)(q.r7,{children:xe&&Oe(xe)?"Remove Admin Privileges":"Grant Admin Privileges"}),(0,J.jsx)(q.$v,{children:xe&&Oe(xe)?"Are you sure you want to remove admin privileges from ".concat((null===xe||void 0===xe?void 0:xe.displayName)||(null===xe||void 0===xe?void 0:xe.email),"? They will no longer be able to access the admin dashboard."):"Are you sure you want to make ".concat((null===xe||void 0===xe?void 0:xe.displayName)||(null===xe||void 0===xe?void 0:xe.email)," an admin? They will have full access to the admin dashboard and all management features.")})]}),(0,J.jsxs)(q.ck,{children:[(0,J.jsx)(q.Zr,{children:"Cancel"}),(0,J.jsx)(q.Rx,{onClick:()=>{return e=xe&&Oe(xe)?"user":"admin",void(xe&&Se.mutate({uid:xe.uid,role:e}));var e},disabled:Se.isPending,children:Se.isPending?"Updating...":"Confirm"})]})]})}),(0,J.jsx)(q.Lt,{open:ie,onOpenChange:te,children:(0,J.jsxs)(q.EO,{children:[(0,J.jsxs)(q.wd,{children:[(0,J.jsx)(q.r7,{children:"Delete User"}),(0,J.jsxs)(q.$v,{children:["Are you sure you want to delete"," ",(0,J.jsx)("span",{className:"font-semibold",children:(null===oe||void 0===oe?void 0:oe.displayName)||(null===oe||void 0===oe?void 0:oe.email)}),"? This action cannot be undone and will permanently remove the user from Firebase Authentication."]})]}),(0,J.jsxs)(q.ck,{children:[(0,J.jsx)(q.Zr,{children:"Cancel"}),(0,J.jsx)(q.Rx,{onClick:()=>{oe&&Fe.mutate(oe.uid)},disabled:Fe.isPending,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:Fe.isPending?"Deleting...":"Delete User"})]})]})}),(0,J.jsx)(V.lG,{open:de,onOpenChange:ce,children:(0,J.jsxs)(V.Cf,{className:"max-w-md",children:[(0,J.jsxs)(V.c7,{children:[(0,J.jsxs)(V.L3,{className:"flex items-center gap-2",children:[(0,J.jsx)(m.A,{className:"h-5 w-5"}),"Change Subscription"]}),(0,J.jsxs)(V.rr,{children:["Update the subscription tier for"," ",(0,J.jsx)("span",{className:"font-semibold",children:(null===he||void 0===he?void 0:he.displayName)||(null===he||void 0===he?void 0:he.email)})]})]}),(0,J.jsxs)("div",{className:"space-y-4 mt-4",children:[(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"Current Subscription"}),he&&qe(Ze(he))]}),(0,J.jsxs)("div",{children:[(0,J.jsx)("label",{className:"text-sm font-medium mb-2 block",children:"New Subscription Tier"}),(0,J.jsxs)(B.l6,{value:je,onValueChange:Ne,children:[(0,J.jsx)(B.bq,{children:(0,J.jsx)(B.yv,{placeholder:"Select a tier"})}),(0,J.jsxs)(B.gC,{children:[(0,J.jsx)(B.eb,{value:W.i9.FREE,children:(0,J.jsxs)("div",{className:"flex items-center gap-2",children:[(0,J.jsx)(P.A,{className:"h-4 w-4"}),"Free"]})}),(0,J.jsx)(B.eb,{value:W.i9.PREMIUM,children:(0,J.jsxs)("div",{className:"flex items-center gap-2",children:[(0,J.jsx)(A.A,{className:"h-4 w-4 text-purple-500"}),"Premium (\u20b949/month)"]})}),(0,J.jsx)(B.eb,{value:W.i9.PREMIUM_PLUS,children:(0,J.jsxs)("div",{className:"flex items-center gap-2",children:[(0,J.jsx)(x.A,{className:"h-4 w-4 text-amber-500"}),"Premium Plus (\u20b999/month)"]})}),(0,J.jsx)(B.eb,{value:W.i9.ENTERPRISE,children:(0,J.jsxs)("div",{className:"flex items-center gap-2",children:[(0,J.jsx)(c.A,{className:"h-4 w-4 text-emerald-500"}),"Enterprise"]})})]})]})]}),je&&(0,J.jsxs)("div",{className:"p-3 rounded-lg bg-muted text-sm",children:[je===W.i9.FREE&&(0,J.jsx)("p",{children:"10 minutes per session, English only, resets every 2 hours"}),je===W.i9.PREMIUM&&(0,J.jsx)("p",{children:"5 hours daily, all languages, offline downloads"}),je===W.i9.PREMIUM_PLUS&&(0,J.jsx)("p",{children:"Unlimited playback, all languages, priority support"}),je===W.i9.ENTERPRISE&&(0,J.jsx)("p",{children:"Unlimited access, API access, custom billing"})]})]}),(0,J.jsxs)("div",{className:"flex gap-2 mt-6",children:[(0,J.jsx)(M.$,{variant:"outline",className:"flex-1",onClick:()=>ce(!1),children:"Cancel"}),(0,J.jsx)(M.$,{className:"flex-1",onClick:()=>{console.log("[Admin] confirmSubscriptionChange called:",{user:he,tier:je}),he&&je?Te.mutate({uid:he.uid,subscriptionTier:je}):console.warn("[Admin] Missing user or tier:",{hasUser:!!he,hasTier:!!je})},disabled:!je||Te.isPending,children:Te.isPending?"Updating...":"Update Subscription"})]})]})})]})}},92264:(e,s,a)=>{a.d(s,{p:()=>c});var l=a(27051),i=a(53986),t=a(65043),r=a(99766),n=a(70579);const d=["className","type"],c=t.forwardRef((e,s)=>{let{className:a,type:t}=e,c=(0,i.A)(e,d);return(0,n.jsx)("input",(0,l.A)({type:t,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200",a),ref:s},c))});c.displayName="Input"}}]);
//# sourceMappingURL=366.96969a55.chunk.js.map