"use strict";(self.webpackChunkmediacore_frontend=self.webpackChunkmediacore_frontend||[]).push([[436],{13416:(e,s,a)=>{a.d(s,{T:()=>c});var l=a(27051),t=a(53986),i=a(65043),r=a(99766),n=a(70579);const d=["className"],c=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,d);return(0,n.jsx)("textarea",(0,l.A)({className:(0,r.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:s},i))});c.displayName="Textarea"},15436:(e,s,a)=>{a.r(s),a.d(s,{default:()=>G});var l=a(27051),t=a(65043),i=a(73216),r=a(35475),n=a(63248),d=a(12265),c=a(47097),o=a(14459),m=a(65469),u=a(48186),x=a(64265),h=a(70764),p=a(9855),g=a(71360),j=a(29521),v=a(19829),f=a(64830),b=a(36360),N=a(36210),y=a(84259),A=a(57170),w=a(40614),C=a(38276),k=a(66305),I=a(18717),E=a(91140),S=a(92264),T=a(13390),R=a(5949),L=a(59938),D=a(13416),F=a(31555),J=a(65598),$=a(17484),q=a(84370),O=a(19690),Q=a(53986),z=a(76622),P=a(99766),M=a(70579);const U=["className"],_=t.forwardRef((e,s)=>{let{className:a}=e,t=(0,Q.A)(e,U);return(0,M.jsx)(z.bL,(0,l.A)((0,l.A)({ref:s,className:(0,P.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a)},t),{},{children:(0,M.jsx)(z.C1,{className:(0,P.cn)("flex items-center justify-center text-current"),children:(0,M.jsx)(N.A,{className:"h-4 w-4"})})}))});_.displayName=z.bL.displayName;const B=[{value:"album",label:"Album"},{value:"single",label:"Single"},{value:"ep",label:"EP"},{value:"compilation",label:"Compilation"},{value:"audiobook",label:"Audiobook"},{value:"lecture",label:"Lecture Series"}];function G(){const{artistId:e}=(0,i.g)(),s=(0,i.Zp)(),a=(0,n.jE)(),{addToast:y}=(0,I.j_)(),{playTrack:A,setQueue:w}=(0,I.ut)(),[C,Q]=(0,t.useState)("albums"),[z,U]=(0,t.useState)(!1),[G,W]=(0,t.useState)(!1),[V,K]=(0,t.useState)(!1),[X,H]=(0,t.useState)(!1),[Y,ee]=(0,t.useState)(!1),[se,ae]=(0,t.useState)(!1),[le,te]=(0,t.useState)(null),[ie,re]=(0,t.useState)([]),[ne,de]=(0,t.useState)({title:"",description:"",coverImage:"",releaseDate:"",genre:"",type:"album"}),[ce,oe]=(0,t.useState)({name:"",bio:"",genre:"",image:"",website:""}),{data:me,isLoading:ue}=(0,d.I)({queryKey:["artist",e],queryFn:()=>k.O0.getArtistById(e),enabled:!!e}),{data:xe,isLoading:he}=(0,d.I)({queryKey:["artist-albums",e],queryFn:()=>k.O0.getArtistAlbums(e),enabled:!!e}),{data:pe,isLoading:ge}=(0,d.I)({queryKey:["artist-media",e],queryFn:()=>k.O0.getArtistMedia(e),enabled:!!e}),{data:je}=(0,d.I)({queryKey:["admin-media"],queryFn:()=>k.O0.getMedia({limit:500})}),ve=null===me||void 0===me?void 0:me.data,fe=(0,t.useMemo)(()=>(null===xe||void 0===xe?void 0:xe.data)||[],[null===xe||void 0===xe?void 0:xe.data]),be=(0,t.useMemo)(()=>(null===pe||void 0===pe?void 0:pe.data)||[],[null===pe||void 0===pe?void 0:pe.data]),Ne=(0,t.useMemo)(()=>(null===je||void 0===je?void 0:je.data)||[],[null===je||void 0===je?void 0:je.data]),[ye,Ae]=(0,t.useState)({}),we=(0,t.useMemo)(()=>{const e=new Set;return fe.forEach(s=>{(ye[s.id]||[]).forEach(s=>e.add(s.id))}),Ne.filter(s=>!e.has(s.id))},[Ne,fe,ye]),Ce=async e=>{if(ye[e])return ye[e];try{const s=await k.O0.getAlbumMedia(e),a=(null===s||void 0===s?void 0:s.data)||[];return Ae(s=>(0,l.A)((0,l.A)({},s),{},{[e]:a})),a}catch(s){return console.error("Failed to fetch album tracks:",s),[]}},ke=(0,c.n)({mutationFn:s=>k.ic.createAlbum((0,l.A)((0,l.A)({},s),{},{artistId:e})),onSuccess:()=>{a.invalidateQueries(["artist-albums",e]),U(!1),de({title:"",description:"",coverImage:"",releaseDate:"",genre:"",type:"album"}),y({message:"Album created successfully",type:"success"})},onError:e=>{var s,a;y({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to create album",type:"error"})}}),Ie=(0,c.n)({mutationFn:e=>{let{id:s,data:a}=e;return k.ic.updateAlbum(s,a)},onSuccess:()=>{a.invalidateQueries(["artist-albums",e]),W(!1),te(null),y({message:"Album updated successfully",type:"success"})},onError:e=>{var s,a;y({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to update album",type:"error"})}}),Ee=(0,c.n)({mutationFn:e=>k.ic.deleteAlbum(e),onSuccess:()=>{a.invalidateQueries(["artist-albums",e]),a.invalidateQueries(["artist-media",e]),K(!1),te(null),y({message:"Album deleted successfully",type:"success"})},onError:e=>{var s,a;y({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to delete album",type:"error"})}}),Se=(0,c.n)({mutationFn:s=>k.ic.updateArtist(e,s),onSuccess:()=>{a.invalidateQueries(["artist",e]),a.invalidateQueries(["artists"]),ee(!1),y({message:"Artist updated successfully",type:"success"})},onError:e=>{var s,a;y({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to update artist",type:"error"})}}),Te=(0,c.n)({mutationFn:()=>k.ic.deleteArtist(e,!0),onSuccess:()=>{a.invalidateQueries(["artists"]),s("/admin/artists"),y({message:"Artist deleted successfully",type:"success"})},onError:e=>{var s,a;y({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to delete artist",type:"error"})}}),Re=(0,c.n)({mutationFn:e=>{let{albumId:s,mediaId:a,trackNumber:l}=e;return k.ic.addMediaToAlbum(s,a,l)},onSuccess:(s,t)=>{a.invalidateQueries(["album-media",t.albumId]),a.invalidateQueries(["artist-media",e]),Ae(e=>{const s=(0,l.A)({},e);return delete s[t.albumId],s})},onError:e=>{var s,a;y({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to add track",type:"error"})}}),Le=(0,c.n)({mutationFn:e=>{let{albumId:s,mediaId:a}=e;return k.ic.removeMediaFromAlbum(s,a)},onSuccess:(s,t)=>{a.invalidateQueries(["album-media",t.albumId]),a.invalidateQueries(["artist-media",e]),Ae(e=>{const s=(0,l.A)({},e);return delete s[t.albumId],s}),y({message:"Track removed from album",type:"success"})},onError:e=>{var s,a;y({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to remove track",type:"error"})}}),De=(0,c.n)({mutationFn:e=>{let{albumId:s,tracks:a}=e;return k.ic.reorderAlbumTracks(s,a)},onSuccess:(e,s)=>{Ae(e=>{const a=(0,l.A)({},e);return delete a[s.albumId],a})},onError:e=>{var s,a;y({message:(null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||"Failed to reorder tracks",type:"error"})}});if(ue)return(0,M.jsx)("div",{className:"space-y-6",children:(0,M.jsxs)("div",{className:"flex items-start gap-4",children:[(0,M.jsx)(F.E,{className:"h-10 w-10"}),(0,M.jsxs)("div",{className:"flex-1 flex gap-6",children:[(0,M.jsx)(F.E,{className:"w-48 h-48 rounded-xl"}),(0,M.jsxs)("div",{className:"flex-1 space-y-4",children:[(0,M.jsx)(F.E,{className:"h-10 w-64"}),(0,M.jsx)(F.E,{className:"h-6 w-32"}),(0,M.jsx)(F.E,{className:"h-20 w-full max-w-xl"})]})]})]})});if(!ve)return(0,M.jsxs)("div",{className:"text-center py-12",children:[(0,M.jsx)(o.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,M.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Artist not found"}),(0,M.jsx)(T.$,{asChild:!0,children:(0,M.jsx)(r.N_,{to:"/admin/artists",children:"Back to Artists"})})]});const Fe=()=>{de({title:"",description:"",coverImage:"",releaseDate:"",genre:ve.genre||"",type:"album"}),U(!0)},Je=e=>{var s;te(e),de({title:e.title,description:e.description||"",coverImage:e.coverImage||"",releaseDate:(null===(s=e.releaseDate)||void 0===s?void 0:s.split("T")[0])||"",genre:e.genre||"",type:e.type||"album"}),W(!0)},$e=e=>{te(e),K(!0)},qe=e=>{te(e),re([]),H(!0)},Oe=e=>{re(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])},Qe=async(e,s,a)=>{if(!e.destination)return;const t=Array.from(a),[i]=t.splice(e.source.index,1);t.splice(e.destination.index,0,i),Ae(e=>(0,l.A)((0,l.A)({},e),{},{[s]:t}));const r=t.map((e,s)=>({mediaId:e.id,trackNumber:s+1}));await De.mutateAsync({albumId:s,tracks:r})},ze=async e=>{let s=ye[e.id];s||(s=await Ce(e.id)),s.length>0&&(w(s,0),A(s[0],s))},Pe=(e,s)=>{A(e,s)};return(0,M.jsxs)("div",{className:"space-y-6",children:[(0,M.jsxs)("div",{className:"flex items-start gap-4",children:[(0,M.jsx)(T.$,{variant:"ghost",size:"icon",asChild:!0,children:(0,M.jsx)(r.N_,{to:"/admin/artists",children:(0,M.jsx)(m.A,{className:"h-5 w-5"})})}),(0,M.jsxs)("div",{className:"flex-1 flex flex-col md:flex-row gap-6",children:[(0,M.jsx)("div",{className:(0,P.cn)("w-32 h-32 md:w-48 md:h-48 rounded-xl shrink-0 overflow-hidden",!ve.image&&"bg-gradient-to-br ".concat((0,P.O3)(ve.id))),children:ve.image?(0,M.jsx)("img",{src:ve.image,alt:ve.name,className:"w-full h-full object-cover"}):(0,M.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,M.jsx)(o.A,{className:"h-16 w-16 text-white/50"})})}),(0,M.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,M.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)("h1",{className:"text-3xl font-bold",children:ve.name}),(0,M.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[ve.genre&&(0,M.jsx)(R.E,{variant:"secondary",children:ve.genre}),(0,M.jsxs)("span",{className:"text-muted-foreground",children:[fe.length," albums \u2022 ",be.length," tracks"]})]})]}),(0,M.jsxs)($.rI,{children:[(0,M.jsx)($.ty,{asChild:!0,children:(0,M.jsx)(T.$,{variant:"outline",size:"icon",children:(0,M.jsx)(u.A,{className:"h-5 w-5"})})}),(0,M.jsxs)($.SQ,{align:"end",children:[(0,M.jsxs)($._2,{onClick:()=>{oe({name:ve.name,bio:ve.bio||"",genre:ve.genre||"",image:ve.image||"",website:ve.website||""}),ee(!0)},children:[(0,M.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Edit Artist"]}),ve.website&&(0,M.jsx)($._2,{asChild:!0,children:(0,M.jsxs)("a",{href:ve.website,target:"_blank",rel:"noopener noreferrer",children:[(0,M.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"Visit Website"]})}),(0,M.jsx)($.mB,{}),(0,M.jsxs)($._2,{onClick:()=>ae(!0),className:"text-destructive",children:[(0,M.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Delete Artist"]})]})]})]}),ve.bio&&(0,M.jsx)("p",{className:"text-muted-foreground mt-4 line-clamp-3",children:ve.bio})]})]})]}),(0,M.jsxs)(O.tU,{value:C,onValueChange:Q,children:[(0,M.jsxs)("div",{className:"flex items-center justify-between",children:[(0,M.jsxs)(O.j7,{children:[(0,M.jsx)(O.Xi,{value:"albums",children:"Albums"}),(0,M.jsx)(O.Xi,{value:"tracks",children:"All Tracks"})]}),"albums"===C&&(0,M.jsxs)(T.$,{onClick:Fe,children:[(0,M.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Add Album"]})]}),(0,M.jsx)(O.av,{value:"albums",className:"space-y-6",children:he?(0,M.jsx)("div",{className:"space-y-4",children:Array.from({length:3}).map((e,s)=>(0,M.jsx)(E.Zp,{children:(0,M.jsx)(E.Wu,{className:"p-6",children:(0,M.jsxs)("div",{className:"flex gap-4",children:[(0,M.jsx)(F.E,{className:"w-24 h-24 rounded-lg"}),(0,M.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,M.jsx)(F.E,{className:"h-6 w-48"}),(0,M.jsx)(F.E,{className:"h-4 w-32"})]})]})})},s))}):0===fe.length?(0,M.jsx)(E.Zp,{children:(0,M.jsxs)(E.Wu,{className:"text-center py-12",children:[(0,M.jsx)(j.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,M.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No albums yet"}),(0,M.jsx)("p",{className:"text-muted-foreground mb-4",children:"Create albums to organize this artist's content"}),(0,M.jsxs)(T.$,{onClick:Fe,children:[(0,M.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Create First Album"]})]})}):fe.map(e=>(0,M.jsx)(Z,{album:e,albumTracksCache:ye,fetchAlbumTracks:Ce,onEditAlbum:Je,onDeleteAlbum:$e,onAssignMedia:qe,onPlayAlbum:ze,onPlayTrack:Pe,onRemoveTrack:s=>Le.mutate({albumId:e.id,mediaId:s.id}),onDragEnd:Qe,addToast:y},e.id))}),(0,M.jsx)(O.av,{value:"tracks",children:(0,M.jsx)(E.Zp,{children:(0,M.jsx)(E.Wu,{className:"p-0",children:ge?(0,M.jsx)("div",{className:"p-4 space-y-2",children:Array.from({length:5}).map((e,s)=>(0,M.jsx)(F.E,{className:"h-12 w-full"},s))}):0===be.length?(0,M.jsxs)("div",{className:"text-center py-12",children:[(0,M.jsx)(v.A,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),(0,M.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"No tracks assigned"}),(0,M.jsx)("p",{className:"text-muted-foreground",children:"Upload media and assign it to this artist"})]}):(0,M.jsx)("div",{className:"divide-y",children:be.map((e,s)=>(0,M.jsxs)("div",{className:"flex items-center gap-3 p-3 hover:bg-muted/50 group",children:[(0,M.jsx)("span",{className:"w-8 text-sm text-muted-foreground text-center",children:s+1}),(0,M.jsx)("div",{className:(0,P.cn)("w-10 h-10 rounded shrink-0","bg-gradient-to-br ".concat((0,P.O3)(e.id))),children:e.thumbnail&&(0,M.jsx)("img",{src:e.thumbnail,alt:"",className:"w-full h-full object-cover rounded"})}),(0,M.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,M.jsx)("p",{className:"font-medium truncate",children:e.title}),(0,M.jsx)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:e.albumId?(0,M.jsx)(R.E,{variant:"secondary",className:"text-xs",children:"In Album"}):(0,M.jsx)(R.E,{variant:"outline",className:"text-xs",children:"Single"})})]}),(0,M.jsx)(R.E,{variant:"video"===e.type?"default":"secondary",children:e.type}),(0,M.jsx)(T.$,{variant:"ghost",size:"iconSm",className:"opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>Pe(e,be),children:(0,M.jsx)(f.A,{className:"h-4 w-4"})})]},e.id))})})})})]}),(0,M.jsx)(J.lG,{open:z,onOpenChange:U,children:(0,M.jsxs)(J.Cf,{className:"max-w-md",children:[(0,M.jsxs)(J.c7,{children:[(0,M.jsx)(J.L3,{children:"Add New Album"}),(0,M.jsxs)(J.rr,{children:["Create a new album for ",ve.name]})]}),(0,M.jsxs)("div",{className:"space-y-4 py-4",children:[(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Title *"}),(0,M.jsx)(S.p,{value:ne.title,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{title:e.target.value})),placeholder:"Album title"})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Type"}),(0,M.jsxs)(q.l6,{value:ne.type,onValueChange:e=>de((0,l.A)((0,l.A)({},ne),{},{type:e})),children:[(0,M.jsx)(q.bq,{children:(0,M.jsx)(q.yv,{placeholder:"Select type"})}),(0,M.jsx)(q.gC,{children:B.map(e=>(0,M.jsx)(q.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Genre"}),(0,M.jsx)(S.p,{value:ne.genre,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{genre:e.target.value})),placeholder:"e.g., Spirituality, Jazz"})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Description"}),(0,M.jsx)(D.T,{value:ne.description,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{description:e.target.value})),placeholder:"Album description",rows:2})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Cover Image URL"}),(0,M.jsx)(S.p,{value:ne.coverImage,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{coverImage:e.target.value})),placeholder:"https://example.com/cover.jpg"})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Release Date"}),(0,M.jsx)(S.p,{type:"date",value:ne.releaseDate,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{releaseDate:e.target.value}))})]})]}),(0,M.jsxs)(J.Es,{children:[(0,M.jsx)(T.$,{variant:"ghost",onClick:()=>U(!1),children:"Cancel"}),(0,M.jsxs)(T.$,{onClick:()=>{ne.title.trim()?ke.mutate(ne):y({message:"Album title is required",type:"error"})},disabled:ke.isLoading,children:[ke.isLoading&&(0,M.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Album"]})]})]})}),(0,M.jsx)(J.lG,{open:G,onOpenChange:W,children:(0,M.jsxs)(J.Cf,{className:"max-w-md",children:[(0,M.jsx)(J.c7,{children:(0,M.jsx)(J.L3,{children:"Edit Album"})}),(0,M.jsxs)("div",{className:"space-y-4 py-4",children:[(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Title *"}),(0,M.jsx)(S.p,{value:ne.title,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{title:e.target.value}))})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Type"}),(0,M.jsxs)(q.l6,{value:ne.type,onValueChange:e=>de((0,l.A)((0,l.A)({},ne),{},{type:e})),children:[(0,M.jsx)(q.bq,{children:(0,M.jsx)(q.yv,{})}),(0,M.jsx)(q.gC,{children:B.map(e=>(0,M.jsx)(q.eb,{value:e.value,children:e.label},e.value))})]})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Genre"}),(0,M.jsx)(S.p,{value:ne.genre,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{genre:e.target.value}))})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Description"}),(0,M.jsx)(D.T,{value:ne.description,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{description:e.target.value})),rows:2})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Cover Image URL"}),(0,M.jsx)(S.p,{value:ne.coverImage,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{coverImage:e.target.value}))})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Release Date"}),(0,M.jsx)(S.p,{type:"date",value:ne.releaseDate,onChange:e=>de((0,l.A)((0,l.A)({},ne),{},{releaseDate:e.target.value}))})]})]}),(0,M.jsxs)(J.Es,{children:[(0,M.jsx)(T.$,{variant:"ghost",onClick:()=>W(!1),children:"Cancel"}),(0,M.jsxs)(T.$,{onClick:()=>{ne.title.trim()?Ie.mutate({id:le.id,data:ne}):y({message:"Album title is required",type:"error"})},disabled:Ie.isLoading,children:[Ie.isLoading&&(0,M.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})}),(0,M.jsx)(J.lG,{open:V,onOpenChange:K,children:(0,M.jsxs)(J.Cf,{children:[(0,M.jsxs)(J.c7,{children:[(0,M.jsx)(J.L3,{children:"Delete Album"}),(0,M.jsxs)(J.rr,{children:['Are you sure you want to delete "',null===le||void 0===le?void 0:le.title,'"?']})]}),(0,M.jsx)("p",{className:"text-sm text-muted-foreground py-4",children:"The tracks in this album will not be deleted, but they will become unassigned."}),(0,M.jsxs)(J.Es,{children:[(0,M.jsx)(T.$,{variant:"ghost",onClick:()=>K(!1),children:"Cancel"}),(0,M.jsxs)(T.$,{variant:"destructive",onClick:()=>{Ee.mutate(le.id)},disabled:Ee.isLoading,children:[Ee.isLoading&&(0,M.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete Album"]})]})]})}),(0,M.jsx)(J.lG,{open:X,onOpenChange:H,children:(0,M.jsxs)(J.Cf,{className:"max-w-lg max-h-[80vh] flex flex-col",children:[(0,M.jsxs)(J.c7,{children:[(0,M.jsxs)(J.L3,{children:["Add Tracks to ",null===le||void 0===le?void 0:le.title]}),(0,M.jsx)(J.rr,{children:"Select tracks to add to this album"})]}),(0,M.jsx)("div",{className:"flex-1 overflow-y-auto py-4",children:0===we.length?(0,M.jsxs)("div",{className:"text-center py-8",children:[(0,M.jsx)(v.A,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),(0,M.jsx)("p",{className:"text-muted-foreground",children:"No unassigned media available"})]}):(0,M.jsx)("div",{className:"space-y-1",children:we.map(e=>(0,M.jsxs)("div",{onClick:()=>Oe(e.id),className:(0,P.cn)("flex items-center gap-3 p-2 rounded-lg cursor-pointer transition-colors",ie.includes(e.id)?"bg-primary/20 border border-primary":"hover:bg-muted/50"),children:[(0,M.jsx)(_,{checked:ie.includes(e.id),onCheckedChange:()=>Oe(e.id)}),(0,M.jsx)("div",{className:(0,P.cn)("w-10 h-10 rounded shrink-0","bg-gradient-to-br ".concat((0,P.O3)(e.id))),children:e.thumbnail&&(0,M.jsx)("img",{src:e.thumbnail,alt:"",className:"w-full h-full object-cover rounded"})}),(0,M.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,M.jsx)("p",{className:"font-medium truncate",children:e.title}),(0,M.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.subtitle||"No description"})]}),(0,M.jsx)(R.E,{variant:"video"===e.type?"default":"secondary",children:e.type})]},e.id))})}),(0,M.jsxs)(J.Es,{className:"border-t pt-4",children:[(0,M.jsxs)("div",{className:"flex-1 text-sm text-muted-foreground",children:[ie.length," tracks selected"]}),(0,M.jsx)(T.$,{variant:"ghost",onClick:()=>H(!1),children:"Cancel"}),(0,M.jsxs)(T.$,{onClick:async()=>{if(0===ie.length)return void y({message:"Select at least one track",type:"error"});let s=(ye[le.id]||[]).length+1;console.log("Adding tracks to album:",le.id,"tracks:",ie);try{for(const e of ie)console.log("Adding media:",e,"track number:",s),await Re.mutateAsync({albumId:le.id,mediaId:e,trackNumber:s++});a.invalidateQueries(["album-media",le.id]),a.invalidateQueries(["artist-albums",e]),Ae(e=>{const s=(0,l.A)({},e);return delete s[le.id],s}),H(!1),te(null),re([]),y({message:"".concat(ie.length," tracks added to album"),type:"success"})}catch(r){var t,i;console.error("Failed to add tracks:",r),y({message:(null===(t=r.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.message)||"Failed to add tracks",type:"error"})}},disabled:0===ie.length||Re.isPending,children:[Re.isPending&&(0,M.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),(0,M.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Add to Album"]})]})]})}),(0,M.jsx)(J.lG,{open:Y,onOpenChange:ee,children:(0,M.jsxs)(J.Cf,{className:"max-w-md",children:[(0,M.jsx)(J.c7,{children:(0,M.jsx)(J.L3,{children:"Edit Artist"})}),(0,M.jsxs)("div",{className:"space-y-4 py-4",children:[(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Name *"}),(0,M.jsx)(S.p,{value:ce.name,onChange:e=>oe((0,l.A)((0,l.A)({},ce),{},{name:e.target.value}))})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Genre"}),(0,M.jsx)(S.p,{value:ce.genre,onChange:e=>oe((0,l.A)((0,l.A)({},ce),{},{genre:e.target.value}))})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Biography"}),(0,M.jsx)(D.T,{value:ce.bio,onChange:e=>oe((0,l.A)((0,l.A)({},ce),{},{bio:e.target.value})),rows:3})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Image URL"}),(0,M.jsx)(S.p,{value:ce.image,onChange:e=>oe((0,l.A)((0,l.A)({},ce),{},{image:e.target.value}))})]}),(0,M.jsxs)("div",{className:"space-y-2",children:[(0,M.jsx)(L.J,{children:"Website"}),(0,M.jsx)(S.p,{value:ce.website,onChange:e=>oe((0,l.A)((0,l.A)({},ce),{},{website:e.target.value}))})]})]}),(0,M.jsxs)(J.Es,{children:[(0,M.jsx)(T.$,{variant:"ghost",onClick:()=>ee(!1),children:"Cancel"}),(0,M.jsxs)(T.$,{onClick:()=>{ce.name.trim()?Se.mutate(ce):y({message:"Artist name is required",type:"error"})},disabled:Se.isLoading,children:[Se.isLoading&&(0,M.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})]})}),(0,M.jsx)(J.lG,{open:se,onOpenChange:ae,children:(0,M.jsxs)(J.Cf,{children:[(0,M.jsxs)(J.c7,{children:[(0,M.jsx)(J.L3,{children:"Delete Artist"}),(0,M.jsxs)(J.rr,{children:['Are you sure you want to delete "',ve.name,'"?']})]}),(0,M.jsx)("p",{className:"text-sm text-muted-foreground py-4",children:"This will delete all albums associated with this artist. Media files will not be deleted but will become unassigned."}),(0,M.jsxs)(J.Es,{children:[(0,M.jsx)(T.$,{variant:"ghost",onClick:()=>ae(!1),children:"Cancel"}),(0,M.jsxs)(T.$,{variant:"destructive",onClick:()=>{Te.mutate()},disabled:Te.isLoading,children:[Te.isLoading&&(0,M.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Delete Artist"]})]})]})})]})}function Z(e){var s;let{album:a,albumTracksCache:i,fetchAlbumTracks:r,onEditAlbum:n,onDeleteAlbum:d,onAssignMedia:c,onPlayAlbum:o,onPlayTrack:m,onRemoveTrack:h,onDragEnd:b,addToast:N}=e;const[k,I]=(0,t.useState)([]),[S,L]=(0,t.useState)(!0);return t.useEffect(()=>{(async()=>{L(!0);const e=await r(a.id);I(e),L(!1)})()},[a.id,r,i[a.id]]),(0,M.jsxs)(E.Zp,{children:[(0,M.jsx)(E.aR,{children:(0,M.jsxs)("div",{className:"flex items-start gap-4",children:[(0,M.jsx)("div",{className:(0,P.cn)("w-24 h-24 rounded-lg shrink-0 overflow-hidden",!a.coverImage&&"bg-gradient-to-br ".concat((0,P.O3)(a.id))),children:a.coverImage?(0,M.jsx)("img",{src:a.coverImage,alt:a.title,className:"w-full h-full object-cover"}):(0,M.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,M.jsx)(j.A,{className:"h-10 w-10 text-white/50"})})}),(0,M.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,M.jsxs)("div",{className:"flex items-start justify-between",children:[(0,M.jsxs)("div",{children:[(0,M.jsx)(E.ZB,{className:"text-xl",children:a.title}),(0,M.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-sm text-muted-foreground",children:[(0,M.jsx)(R.E,{variant:"outline",children:(null===(s=B.find(e=>e.value===a.type))||void 0===s?void 0:s.label)||"Album"}),(0,M.jsxs)("span",{children:[a.trackCount||k.length," tracks"]}),a.releaseDate&&(0,M.jsxs)("span",{children:["\u2022 ",a.releaseDate.split("T")[0]]})]})]}),(0,M.jsxs)("div",{className:"flex items-center gap-2",children:[k.length>0&&(0,M.jsx)(T.$,{variant:"spotify",size:"icon",onClick:()=>o(a),children:(0,M.jsx)(f.A,{className:"h-5 w-5 ml-0.5"})}),(0,M.jsxs)($.rI,{children:[(0,M.jsx)($.ty,{asChild:!0,children:(0,M.jsx)(T.$,{variant:"ghost",size:"icon",children:(0,M.jsx)(u.A,{className:"h-5 w-5"})})}),(0,M.jsxs)($.SQ,{align:"end",children:[(0,M.jsxs)($._2,{onClick:()=>c(a),children:[(0,M.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Add Tracks"]}),(0,M.jsxs)($._2,{onClick:()=>n(a),children:[(0,M.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Edit Album"]}),(0,M.jsx)($.mB,{}),(0,M.jsxs)($._2,{onClick:()=>d(a),className:"text-destructive",children:[(0,M.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Delete Album"]})]})]})]})]}),a.description&&(0,M.jsx)("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:a.description})]})]})}),(0,M.jsx)(E.Wu,{children:S?(0,M.jsx)("div",{className:"space-y-2",children:Array.from({length:3}).map((e,s)=>(0,M.jsx)(F.E,{className:"h-12 w-full"},s))}):0===k.length?(0,M.jsxs)("div",{className:"text-center py-6 border border-dashed rounded-lg",children:[(0,M.jsx)(v.A,{className:"h-8 w-8 mx-auto text-muted-foreground mb-2"}),(0,M.jsx)("p",{className:"text-sm text-muted-foreground mb-3",children:"No tracks in this album"}),(0,M.jsxs)(T.$,{variant:"outline",size:"sm",onClick:()=>c(a),children:[(0,M.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Add Tracks"]})]}):(0,M.jsx)(C.JY,{onDragEnd:e=>b(e,a.id,k),children:(0,M.jsx)(C.gL,{droppableId:a.id,children:e=>(0,M.jsxs)("div",(0,l.A)((0,l.A)({ref:e.innerRef},e.droppableProps),{},{className:"space-y-1",children:[k.map((e,s)=>(0,M.jsx)(C.sx,{draggableId:e.id,index:s,children:(a,t)=>(0,M.jsxs)("div",(0,l.A)((0,l.A)({ref:a.innerRef},a.draggableProps),{},{className:(0,P.cn)("flex items-center gap-3 p-2 rounded-lg group hover:bg-muted/50",t.isDragging&&"bg-muted shadow-lg"),children:[(0,M.jsx)("div",(0,l.A)((0,l.A)({},a.dragHandleProps),{},{className:"text-muted-foreground hover:text-foreground cursor-grab",children:(0,M.jsx)(y.A,{className:"h-4 w-4"})})),(0,M.jsx)("span",{className:"w-6 text-sm text-muted-foreground text-center",children:e.trackNumber||s+1}),(0,M.jsx)("div",{className:(0,P.cn)("w-10 h-10 rounded shrink-0","bg-gradient-to-br ".concat((0,P.O3)(e.id))),children:e.thumbnail&&(0,M.jsx)("img",{src:e.thumbnail,alt:"",className:"w-full h-full object-cover rounded"})}),(0,M.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,M.jsx)("p",{className:"font-medium truncate",children:e.title}),(0,M.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:["video"===e.type?(0,M.jsx)(A.A,{className:"h-3 w-3"}):(0,M.jsx)(v.A,{className:"h-3 w-3"}),(0,M.jsx)("span",{children:e.type})]})]}),(0,M.jsxs)("div",{className:"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,M.jsx)(T.$,{variant:"ghost",size:"iconSm",onClick:()=>m(e,k),children:(0,M.jsx)(f.A,{className:"h-4 w-4"})}),(0,M.jsx)(T.$,{variant:"ghost",size:"iconSm",onClick:()=>h(e),children:(0,M.jsx)(w.A,{className:"h-4 w-4"})})]})]}))},e.id)),e.placeholder]}))})})})]})}},19690:(e,s,a)=>{a.d(s,{Xi:()=>h,av:()=>p,j7:()=>x,tU:()=>u});var l=a(27051),t=a(53986),i=a(65043),r=a(47127),n=a(99766),d=a(70579);const c=["className"],o=["className"],m=["className"],u=r.bL,x=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,c);return(0,d.jsx)(r.B8,(0,l.A)({ref:s,className:(0,n.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",a)},i))});x.displayName=r.B8.displayName;const h=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,o);return(0,d.jsx)(r.l9,(0,l.A)({ref:s,className:(0,n.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",a)},i))});h.displayName=r.l9.displayName;const p=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,m);return(0,d.jsx)(r.UC,(0,l.A)({ref:s,className:(0,n.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a)},i))});p.displayName=r.UC.displayName},31555:(e,s,a)=>{a.d(s,{E:()=>d});var l=a(27051),t=a(53986),i=(a(65043),a(99766)),r=a(70579);const n=["className"];function d(e){let{className:s}=e,a=(0,t.A)(e,n);return(0,r.jsx)("div",(0,l.A)({className:(0,i.cn)("animate-pulse rounded-md bg-muted",s)},a))}},59938:(e,s,a)=>{a.d(s,{J:()=>u});var l=a(27051),t=a(53986),i=a(65043),r=a(65131),n=a(10917),d=a(99766),c=a(70579);const o=["className"],m=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,o);return(0,c.jsx)(r.b,(0,l.A)({ref:s,className:(0,d.cn)(m(),a)},i))});u.displayName=r.b.displayName},84370:(e,s,a)=>{a.d(s,{bq:()=>N,eb:()=>C,gC:()=>w,l6:()=>f,yv:()=>b});var l=a(27051),t=a(53986),i=a(65043),r=a(22095),n=a(36210),d=a(92382),c=a(15711),o=a(99766),m=a(70579);const u=["className","children"],x=["className"],h=["className"],p=["className","children","position"],g=["className"],j=["className","children"],v=["className"],f=r.bL,b=(r.YJ,r.WT),N=i.forwardRef((e,s)=>{let{className:a,children:i}=e,n=(0,t.A)(e,u);return(0,m.jsxs)(r.l9,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a)},n),{},{children:[i,(0,m.jsx)(r.In,{asChild:!0,children:(0,m.jsx)(d.A,{className:"h-4 w-4 opacity-50"})})]}))});N.displayName=r.l9.displayName;const y=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,x);return(0,m.jsx)(r.PP,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a)},i),{},{children:(0,m.jsx)(c.A,{className:"h-4 w-4"})}))});y.displayName=r.PP.displayName;const A=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,h);return(0,m.jsx)(r.wn,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a)},i),{},{children:(0,m.jsx)(d.A,{className:"h-4 w-4"})}))});A.displayName=r.wn.displayName;const w=i.forwardRef((e,s)=>{let{className:a,children:i,position:n="popper"}=e,d=(0,t.A)(e,p);return(0,m.jsx)(r.ZL,{children:(0,m.jsxs)(r.UC,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:n},d),{},{children:[(0,m.jsx)(y,{}),(0,m.jsx)(r.LM,{className:(0,o.cn)("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:i}),(0,m.jsx)(A,{})]}))})});w.displayName=r.UC.displayName;i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,g);return(0,m.jsx)(r.JU,(0,l.A)({ref:s,className:(0,o.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a)},i))}).displayName=r.JU.displayName;const C=i.forwardRef((e,s)=>{let{className:a,children:i}=e,d=(0,t.A)(e,j);return(0,m.jsxs)(r.q7,(0,l.A)((0,l.A)({ref:s,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a)},d),{},{children:[(0,m.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,m.jsx)(r.VF,{children:(0,m.jsx)(n.A,{className:"h-4 w-4"})})}),(0,m.jsx)(r.p4,{children:i})]}))});C.displayName=r.q7.displayName;i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,v);return(0,m.jsx)(r.wv,(0,l.A)({ref:s,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a)},i))}).displayName=r.wv.displayName},91140:(e,s,a)=>{a.d(s,{BT:()=>j,Wu:()=>v,ZB:()=>g,Zp:()=>h,aR:()=>p});var l=a(27051),t=a(53986),i=a(65043),r=a(99766),n=a(70579);const d=["className"],c=["className"],o=["className","children"],m=["className"],u=["className"],x=["className"],h=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,d);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm transition-all duration-300",a)},i))});h.displayName="Card";const p=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,c);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",a)},i))});p.displayName="CardHeader";const g=i.forwardRef((e,s)=>{let{className:a,children:i}=e,d=(0,t.A)(e,o);return(0,n.jsx)("h3",(0,l.A)((0,l.A)({ref:s,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",a)},d),{},{children:i}))});g.displayName="CardTitle";const j=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,m);return(0,n.jsx)("p",(0,l.A)({ref:s,className:(0,r.cn)("text-sm text-muted-foreground",a)},i))});j.displayName="CardDescription";const v=i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,u);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("p-6 pt-0",a)},i))});v.displayName="CardContent";i.forwardRef((e,s)=>{let{className:a}=e,i=(0,t.A)(e,x);return(0,n.jsx)("div",(0,l.A)({ref:s,className:(0,r.cn)("flex items-center p-6 pt-0",a)},i))}).displayName="CardFooter"},92264:(e,s,a)=>{a.d(s,{p:()=>c});var l=a(27051),t=a(53986),i=a(65043),r=a(99766),n=a(70579);const d=["className","type"],c=i.forwardRef((e,s)=>{let{className:a,type:i}=e,c=(0,t.A)(e,d);return(0,n.jsx)("input",(0,l.A)({type:i,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 transition-all duration-200",a),ref:s},c))});c.displayName="Input"}}]);
//# sourceMappingURL=436.af2b6478.chunk.js.map